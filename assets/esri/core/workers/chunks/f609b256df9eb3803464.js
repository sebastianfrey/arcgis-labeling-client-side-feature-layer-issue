"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[1279],{60999:(t,e,r)=>{r.d(e,{DZ:()=>y,Ke:()=>f,Tj:()=>c,UT:()=>S,aD:()=>_,jJ:()=>u});var n=r(31635),a=r(69622),i=r(97768),s=r(74887),l=r(10107),o=r(64108);function u(t,e,r){return(0,s.Lx)(t.map((t,n)=>e.apply(r,[t,n])))}async function c(t,e,r){return(await(0,s.Lx)(t.map((t,n)=>e.apply(r,[t,n])))).map(t=>t.value)}function h(t){return{ok:!0,value:t}}function p(t){return{ok:!1,error:t}}async function f(t){if(null==t)return{ok:!1,error:new Error("no promise provided")};try{return h(await t)}catch(t){return p(t)}}async function y(t){try{return h(await t)}catch(t){return(0,s.QP)(t),p(t)}}function S(t,e){return new d(t,e)}let d=class extends a.A{get value(){return null!=(t=this._result)&&!0===t.ok?t.value:null;var t}get error(){return null!=(t=this._result)&&!1===t.ok?t.error:null;var t}get finished(){return null!=this._result}constructor(t,e){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=(0,i.DC)(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=t(r),this.promise.then(t=>{this._result=h(t),this._cleanup()},t=>{this._result=p(t),this._cleanup()}),this._abortHandle=(0,s.u7)(e,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=(0,i.xt)(this._abortHandle),this._abortController=null}};(0,n.Cg)([(0,l.MZ)()],d.prototype,"value",null),(0,n.Cg)([(0,l.MZ)()],d.prototype,"error",null),(0,n.Cg)([(0,l.MZ)()],d.prototype,"finished",null),(0,n.Cg)([(0,l.MZ)()],d.prototype,"promise",void 0),(0,n.Cg)([(0,l.MZ)()],d.prototype,"_result",void 0),d=(0,n.Cg)([(0,o.$)("esri.core.asyncUtils.ReactiveTask")],d);class _{constructor(){this._sequence=Promise.resolve()}async acquire(){let t;this._sequence=new Promise(e=>{t=this._sequence.then(()=>e,()=>e)});const e=await t;return{[Symbol.dispose]:e}}async run(t){const e={stack:[],error:void 0,hasError:!1};try{return(0,n.mS)(e,await this.acquire(),!1),await t()}catch(t){e.error=t,e.hasError=!0}finally{(0,n.hk)(e)}}}},85978:(t,e,r)=>{r.d(e,{A:()=>s});var n=r(87449),a=r(11221),i=r(33325);class s extends a.t1{constructor(t){super(),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._parent=t.parentfeatureset,this._databaseType=0}async _queryAll(){return a.An.features}async query(t){return a.An}async queryStat(t){return await this._manualStat(t.stat,t.field,t.limit??i.gO,t.abortSignal)}async canQueryAggregate(t){return!1}async queryAggregate(t){throw new n.dr("NeverReach")}async queryAttachments(){return[]}}},87817:(t,e,r)=>{r.r(e),r.d(e,{registerFunctions:()=>d});var n=r(85935),a=r(78502),i=r(78878),s=r(48938),l=r(87449),o=r(11221),u=r(33325),c=r(71163),h=r(21818),p=r(90634);class f extends o.t1{constructor(t){super(),this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._maxProcessing=40,this._parent=t.parentfeatureset,this._relation=t.relation,this._relationString=t.relationString??"",this._relationGeom=t.relationGeom}get _spatialFilter(){return{relation:"esriSpatialRelRelation"!==this._relation?this._relation:`esriSpatialRelRelation:${this._relationString}`,geometry:this._relationGeom}}async _queryAll(){return(await this.query({abortSignal:s._})).features}async query(t){await this._ensureLoaded();const e=await this._parent.query({...t,spatialFilter:this._spatialFilter});return(0,l.dZ)(t.abortSignal),{...e,spatialFilterApplied:null==t.spatialFilter,features:e.spatialFilterApplied?e.features:this._applySpatialFilter(e.features,t.abortSignal)}}async*_applySpatialFilter(t,e){for await(const r of t){(0,l.dZ)(e);const t=[];for(const e of r)await this._executeSpatialRelationTest(e)&&t.push(e);t.length>0&&(yield t)}}async queryStat(t){if(null!=t.spatialFilter)return{calculated:!1};const e=await this._parent.queryStat({...t,spatialFilter:this._spatialFilter});return e.calculated?e:null==t.where&&null==t.spatialFilter?this._manualStat(t.stat,t.field,t.limit??u.gO,t.abortSignal):{calculated:!1}}async canQueryAggregate(t){return null==t.spatialFilter&&this._parent.canQueryAggregate({...t,spatialFilter:this._spatialFilter})}async queryAggregate(t){if(null!=t.spatialFilter)throw new l.dr("NeverReach");return this._parent.queryAggregate({...t,spatialFilter:this._spatialFilter})}async _executeSpatialRelationTest(t){if(null==t.geometry)return!1;switch(this._relation){case"esriSpatialRelEnvelopeIntersects":{const e=(0,a.Yc)(this._relationGeom),r=(0,p.HA)(t.geometry);return null!=e&&null!=r&&(0,c.C)("intersects",[e.toJSON(),r])}case"esriSpatialRelIntersects":return(0,c.C)("intersects",[this._relationGeom.toJSON(),t.geometry]);case"esriSpatialRelContains":return(0,c.C)("contains",[this._relationGeom.toJSON(),t.geometry]);case"esriSpatialRelOverlaps":return(0,c.C)("overlaps",[this._relationGeom.toJSON(),t.geometry]);case"esriSpatialRelWithin":return(0,c.C)("within",[this._relationGeom.toJSON(),t.geometry]);case"esriSpatialRelTouches":return(0,c.C)("touches",[this._relationGeom.toJSON(),t.geometry]);case"esriSpatialRelCrosses":return(0,c.C)("crosses",[this._relationGeom.toJSON(),t.geometry]);case"esriSpatialRelRelation":return(0,c.C)("relate",[this._relationGeom.toJSON(),t.geometry,this._relationString]);default:return(0,h.Ur)(this._relation),!1}}getFieldsIndex(){return this._parent.getFieldsIndex()}}var y=r(85978);function S(t){return async(e,r,s)=>{if((0,i.B)(s,2,2,e,r),null===(s=(0,i.C)(s))[0]&&null===s[1])return!1;if((0,i.m)(s[0])){if((0,i.h)(s[1]))return new f({parentfeatureset:s[0],relation:t,relationGeom:s[1]});if(null===s[1])return new y.A({parentfeatureset:s[0]});throw new n.D$(e,"InvalidParameter",r)}if((0,i.h)(s[0])){if((0,i.h)(s[1])){switch(t){case"esriSpatialRelEnvelopeIntersects":{const t=(0,a.Yc)(s[0]),e=(0,a.Yc)(s[1]);return null!=t&&null!=e&&(0,c.C)("intersects",[t.toJSON(),e.toJSON()])}case"esriSpatialRelIntersects":return(0,c.C)("intersects",[s[0].toJSON(),s[1].toJSON()]);case"esriSpatialRelContains":return(0,c.C)("contains",[s[0].toJSON(),s[1].toJSON()]);case"esriSpatialRelOverlaps":return(0,c.C)("overlaps",[s[0].toJSON(),s[1].toJSON()]);case"esriSpatialRelWithin":return(0,c.C)("within",[s[0].toJSON(),s[1].toJSON()]);case"esriSpatialRelTouches":return(0,c.C)("touches",[s[0].toJSON(),s[1].toJSON()]);case"esriSpatialRelCrosses":return(0,c.C)("crosses",[s[0].toJSON(),s[1].toJSON()])}throw new n.D$(e,"InvalidParameter",r)}if((0,i.m)(s[1]))return new f({parentfeatureset:s[1],relation:t,relationGeom:s[0]});if(null===s[1])return!1;throw new n.D$(e,"InvalidParameter",r)}if(null===s[0]){if((0,i.m)(s[1]))return new y.A({parentfeatureset:s[1]});if((0,i.h)(s[1])||null===s[1])return!1}throw new n.D$(e,"InvalidParameter",r)}}function d(t){"async"===t.mode&&(t.functions.intersects=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelIntersects"))},t.functions.envelopeintersects=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelEnvelopeIntersects"))},t.signatures.push({name:"envelopeintersects",min:2,max:2}),t.functions.contains=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelContains"))},t.functions.overlaps=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelOverlaps"))},t.functions.within=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelWithin"))},t.functions.touches=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelTouches"))},t.functions.crosses=function(e,r){return t.standardFunctionAsync(e,r,S("esriSpatialRelCrosses"))},t.functions.relate=function(e,r){return t.standardFunctionAsync(e,r,async(t,a,s)=>{if(s=(0,i.C)(s),(0,i.B)(s,3,3,e,r),(0,i.h)(s[0])&&(0,i.h)(s[1]))return(0,c.C)("relate",[s[0].toJSON(),s[1].toJSON(),(0,i.u)(s[2])]);if((0,i.h)(s[0])&&null===s[1])return!1;if((0,i.h)(s[1])&&null===s[0])return!1;if((0,i.m)(s[0])&&null===s[1])return new y.A({parentfeatureset:s[0]});if((0,i.m)(s[1])&&null===s[0])return new y.A({parentfeatureset:s[1]});if((0,i.m)(s[0])&&(0,i.h)(s[1]))return new f({parentfeatureset:s[0],relation:"esriSpatialRelRelation",relationGeom:s[1],relationString:(0,i.u)(s[2])});if((0,i.m)(s[1])&&(0,i.h)(s[0]))return new f({parentfeatureset:s[1],relation:"esriSpatialRelRelation",relationGeom:s[0],relationString:(0,i.u)(s[2])});if(null===s[0]&&null===s[1])return!1;throw new n.D$(e,"InvalidParameter",r)})})}}}]);