"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[3116,7548],{751:(e,t,r)=>{r.d(t,{CJ:()=>h});var n=r(49186),s=r(4718),i=r(93637),a=r(67124),o=r(77548);const l=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),u=new Set(["integrated-mesh-3dtiles"]),c=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),p=new Set([...c,"link-chart"]);function d(e,t){if(t.restrictedWebMapWriting){const r=function(e){switch(e.layerContainerType){case"basemap-base-layers":return l;case"basemap-ground-layers":return u;case"operational-layers":return"link-chart"===e.origin?p:c;default:return null}}(t);return null==r||r.has(e.type)&&!(0,o.Ov)(e)}return!0}function y(e,t){"maxScale"in e&&(t.maxScale=(0,a.B)(e.maxScale)??void 0),"minScale"in e&&(t.minScale=(0,a.B)(e.minScale)??void 0)}function h(e,t,r){if(!e.persistenceEnabled)return null;if(!("write"in e)||!e.write)return r?.messages&&r.messages.push(new n.A("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if((0,o.Ov)(e)&&!e.isTable)t=e.resourceInfo;else if(d(e,r)){const t={};return e.write(t,r)?t:null}return null!=t&&function(e,t){if(function(e,t){if(t)if((0,o.Ov)(e)){const r=(0,i.wc)("featureCollection.layers",t),n=r?.[0]?.layerDefinition;n&&y(e,n)}else"group"!==e.type&&y(e,t)}(e,t),t&&(t.id=e.id,"blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=(0,a.B)(e.opacity)??void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type))if((0,o.Ov)(e)){const r=t.featureCollection;r&&(r.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}(e,t=(0,s.o8)(t)),t}},4146:(e,t,r)=>{r.d(t,{A:()=>b});var n=r(31635),s=r(11254),i=r(49186),a=r(65529),o=r(4902),l=r(92474),u=r(53966),c=r(74887),p=r(84952),d=r(91429),y=r(5443),h=r(16930),g=r(92602),f=r(79677);let m=0,b=class extends((0,a.Zt)((0,o.s)(l.x_))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new y.A(-180,-90,180,90,h.A.WGS84),this.id=Date.now().toString(16)+"-layer-"+m++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=h.A.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const t="string"==typeof e?{url:e}:e;return(await Promise.all([r.e(812),r.e(7982)]).then(r.bind(r,27982))).fromUrl(t)}static fromPortalItem(e){return async function(e){const t="portalItem"in e?e:{portalItem:e},{fromItem:n}=await Promise.all([r.e(812),r.e(5613),r.e(5710)]).then(r.bind(r,45613));try{return await n(t)}catch(e){const r=t?.portalItem,n=r?.id||"unset",s=r?.portal?.url||g.A.portalUrl;throw u.A.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+s+"', id: '"+n+"')",e),e}}(e)}initialize(){this.when().catch(e=>{(0,c.zf)(e)||u.A.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return null!=this.attributionDataUrl}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return(0,p.An)(this.url)}createLayerView(e,t){return Promise.reject(new i.A("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await(0,s.A)(e,{query:{f:"json"},responseType:"json"})).data;throw new i.A("layer:no-attribution-data","Layer does not have attribution data")}};(0,n.Cg)([(0,d.MZ)({type:String})],b.prototype,"attributionDataUrl",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],b.prototype,"effectiveVisible",null),(0,n.Cg)([(0,d.MZ)({type:y.A})],b.prototype,"fullExtent",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],b.prototype,"hasAttributionData",null),(0,n.Cg)([(0,d.MZ)({type:String,clonable:!1})],b.prototype,"id",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean,nonNullable:!0})],b.prototype,"legendEnabled",void 0),(0,n.Cg)([(0,d.MZ)({type:["show","hide","hide-children"]})],b.prototype,"listMode",void 0),(0,n.Cg)([(0,d.MZ)({type:Number,range:{min:0,max:1},nonNullable:!0})],b.prototype,"opacity",void 0),(0,n.Cg)([(0,d.MZ)({clonable:!1})],b.prototype,"parent",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],b.prototype,"parsedUrl",null),(0,n.Cg)([(0,d.MZ)({type:Boolean,readOnly:!0})],b.prototype,"persistenceEnabled",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean})],b.prototype,"popupEnabled",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean})],b.prototype,"attributionVisible",void 0),(0,n.Cg)([(0,d.MZ)({type:h.A})],b.prototype,"spatialReference",void 0),(0,n.Cg)([(0,d.MZ)({type:String})],b.prototype,"title",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0,json:{read:!1}})],b.prototype,"type",void 0),(0,n.Cg)([(0,d.MZ)()],b.prototype,"url",void 0),(0,n.Cg)([(0,d.MZ)({type:f.A})],b.prototype,"visibilityTimeExtent",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean,nonNullable:!0})],b.prototype,"visible",void 0),b=(0,n.Cg)([(0,d.$K)("esri.layers.Layer")],b)},4902:(e,t,r)=>{r.d(t,{s:()=>a});var n=r(31635),s=r(64108);let i=0;const a=e=>{const t=e;let r=class extends t{constructor(...e){super(...e),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+i++})}};return r=(0,n.Cg)([(0,s.$)("esri.core.Identifiable")],r),r};a(class{})},16215:(e,t,r)=>{r.d(t,{S:()=>s,Y:()=>n});const n=Symbol("BasemapInstance");function s(e){return null!=e&&"object"==typeof e&&n in e}},36708:(e,t,r)=>{r.d(t,{C_:()=>d,OH:()=>g,Vh:()=>f,on:()=>p,pc:()=>m,wB:()=>l,z7:()=>u});var n=r(37955),s=r(36563),i=r(97768),a=r(74887),o=r(14012);function l(e,t,r={}){return c(e,t,r,y)}function u(e,t,r={}){return c(e,t,r,h)}function c(e,t,r={},n){let s=null;const a=r.once?(e,r)=>{n(e)&&((0,i.xt)(s),t(e,r))}:(e,r)=>{n(e)&&t(e,r)};if(s=(0,o.Cn)(e,a,r.sync,r.equals),r.initial){const t=e();a(t,t)}return s}function p(e,t,r,a={}){let o=null,u=null,c=null;function p(){o&&u&&(u.remove(),a.onListenerRemove?.(o),o=null,u=null)}function d(e){a.once&&a.once&&(0,i.xt)(c),r(e)}const y=l(e,(e,r)=>{p(),(0,n.wb)(e)&&(o=e,u=(0,n.on)(e,t,d),a.onListenerAdd?.(e))},{sync:a.sync,initial:!0});return c=(0,s.hA)(()=>{y.remove(),p()}),c}function d(e,t){return function(e,t,r){if((0,a.G4)(r))return Promise.reject((0,a.NK)());const n=e();if(t?.(n))return Promise.resolve(n);let o=null;function l(){o=(0,i.xt)(o)}return new Promise((n,i)=>{o=(0,s.vE)([(0,a.u7)(r,()=>{l(),i((0,a.NK)())}),c(e,e=>{l(),n(e)},{sync:!1,once:!0},t??y)])})}(e,h,t)}function y(e){return!0}function h(e){return!!e}r(80559);const g={sync:!0},f={initial:!0},m={sync:!0,initial:!0}},60999:(e,t,r)=>{r.d(t,{DZ:()=>h,Ke:()=>y,Tj:()=>c,UT:()=>g,aD:()=>m,jJ:()=>u});var n=r(31635),s=r(69622),i=r(97768),a=r(74887),o=r(10107),l=r(64108);function u(e,t,r){return(0,a.Lx)(e.map((e,n)=>t.apply(r,[e,n])))}async function c(e,t,r){return(await(0,a.Lx)(e.map((e,n)=>t.apply(r,[e,n])))).map(e=>e.value)}function p(e){return{ok:!0,value:e}}function d(e){return{ok:!1,error:e}}async function y(e){if(null==e)return{ok:!1,error:new Error("no promise provided")};try{return p(await e)}catch(e){return d(e)}}async function h(e){try{return p(await e)}catch(e){return(0,a.QP)(e),d(e)}}function g(e,t){return new f(e,t)}let f=class extends s.A{get value(){return null!=(e=this._result)&&!0===e.ok?e.value:null;var e}get error(){return null!=(e=this._result)&&!1===e.ok?e.error:null;var e}get finished(){return null!=this._result}constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=(0,i.DC)(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(e=>{this._result=p(e),this._cleanup()},e=>{this._result=d(e),this._cleanup()}),this._abortHandle=(0,a.u7)(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=(0,i.xt)(this._abortHandle),this._abortController=null}};(0,n.Cg)([(0,o.MZ)()],f.prototype,"value",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"error",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"finished",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"promise",void 0),(0,n.Cg)([(0,o.MZ)()],f.prototype,"_result",void 0),f=(0,n.Cg)([(0,l.$)("esri.core.asyncUtils.ReactiveTask")],f);class m{constructor(){this._sequence=Promise.resolve()}async acquire(){let e;this._sequence=new Promise(t=>{e=this._sequence.then(()=>t,()=>t)});const t=await e;return{[Symbol.dispose]:t}}async run(e){const t={stack:[],error:void 0,hasError:!1};try{return(0,n.mS)(t,await this.acquire(),!1),await e()}catch(e){t.error=e,t.hasError=!0}finally{(0,n.hk)(t)}}}},62885:(e,t,r)=>{r.d(t,{H:()=>i,V:()=>s});var n=r(7762);function s(e,t,r=n.A){return t||(t=new r),t===e||t.destroyed||(t.removeAll(),(s=e)&&(Array.isArray(s)||"items"in s&&Array.isArray(s.items))?t.addMany(e):e&&t.add(e)),t;var s}function i(e){return e}},77548:(e,t,r)=>{r.d(t,{Gh:()=>m,tk:()=>y,BR:()=>d,wI:()=>p,G$:()=>g,$x:()=>h,Ov:()=>l,UC:()=>i,W_:()=>u,OP:()=>f,TU:()=>o,XX:()=>a,jy:()=>c});var n=r(70333),s=r(11254);function i(e){return null!=e&&"object"==typeof e&&"type"in e&&"knowledge-graph-sublayer"===e.type}r(7762),r(84952),r(36563),r(36708),r(4146),new WeakMap,r(16215);const a={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function o(e){const t=e?.type;return"building-scene"===t||"integrated-mesh"===t||"point-cloud"===t||"scene"===t}function l(e){return"feature"===e?.type&&!e.url&&"memory"===e.source?.type}function u(e){const t=e?.type;return("feature"===t||"subtype-group"===t||"oriented-imagery"===t)&&"feature-layer"===e?.source?.type}function c(e){return function(e){return null!=e&&"object"==typeof e&&"type"in e&&"feature"===e.type}(e)&&function(e){return"feature"===e?.type&&"feature-layer"===e.source?.type}(e)}async function p(e,t){const r=n.id?.findServerInfo(e);if(null!=r?.currentVersion)return r.owningSystemUrl||null;const i=e.toLowerCase().indexOf("/rest/services");if(-1===i)return null;const a=`${e.slice(0,i)}/rest/info`,o=null!=t?t.signal:null,{data:l}=await(0,s.A)(a,{query:{f:"json"},responseType:"json",signal:o});return l?.owningSystemUrl||null}function d(e){return function(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function y(e){return!!function(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}function h(e,t){return null}function g(e){return null}function f(e){return!e||"Feature Service"===e.type&&!e.sourceUrl}function m(e,t){if(!t||!f(e))return;const r=(e.url,null);r&&(e.url=r)}},79677:(e,t,r)=>{r.d(t,{A:()=>p});var n,s=r(31635),i=r(25482),a=r(88930),o=r(91429),l=r(98623),u=r(36005),c=r(43937);let p=class extends i.o{static{n=this}static get allTime(){return d}static get empty(){return y}static fromArray(e){return new n({start:null!=e[0]?new Date(e[0]):e[0],end:null!=e[1]?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?.getTime()??null}get isAllTime(){return this.equals(n.allTime)}get isEmpty(){return this.equals(n.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?.getTime()??null}clone(){return new n({end:this.end,start:this.start})}equals(e){if(!e)return!1;const t=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,n=e.start?.getTime()??e.start,s=e.end?.getTime()??e.end;return t===n&&r===s}expandTo(e,t=l.qU){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=(0,a.lL)(r,e,t));let s=this.end;if(s){const r=(0,a.lL)(s,e,t);s=s.getTime()===r.getTime()?r:(0,a.S1)(r,1,e,t)}return new n({start:r,end:s})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return n.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,s=e.start?.getTime()??-1/0,i=e.end?.getTime()??1/0;let a,o;return s>=t&&s<=r?a=s:t>=s&&t<=i&&(a=t),r>=s&&r<=i?o=r:i>=t&&i<=r&&(o=i),null==a||null==o||isNaN(a)||isNaN(o)?n.empty:new n({start:a===-1/0?null:new Date(a),end:o===1/0?null:new Date(o)})}offset(e,t,r=l.qU){if(this.isEmpty||this.isAllTime)return this.clone();const s=new n,{start:i,end:o}=this;return null!=i&&(s.start=(0,a.S1)(i,e,t,r)),null!=o&&(s.end=(0,a.S1)(o,e,t,r)),s}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return d.clone();const t=null!=this.start&&null!=e.start?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=null!=this.end&&null!=e.end?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new n({start:t,end:r})}};(0,s.Cg)([(0,o.MZ)({type:Date,json:{write:{allowNull:!0}}})],p.prototype,"end",void 0),(0,s.Cg)([(0,u.w)("end")],p.prototype,"readEnd",null),(0,s.Cg)([(0,c.K)("end")],p.prototype,"writeEnd",null),(0,s.Cg)([(0,o.MZ)({readOnly:!0,json:{read:!1}})],p.prototype,"isAllTime",null),(0,s.Cg)([(0,o.MZ)({readOnly:!0,json:{read:!1}})],p.prototype,"isEmpty",null),(0,s.Cg)([(0,o.MZ)({type:Date,json:{write:{allowNull:!0}}})],p.prototype,"start",void 0),(0,s.Cg)([(0,u.w)("start")],p.prototype,"readStart",null),(0,s.Cg)([(0,c.K)("start")],p.prototype,"writeStart",null),p=n=(0,s.Cg)([(0,o.$K)("esri.time.TimeExtent")],p);const d=new p,y=new p({start:void 0,end:void 0})},81583:(e,t,r)=>{r.d(t,{L:()=>o,g:()=>a});var n=r(60999),s=r(7762),i=r(92474);async function a(e,t){return await e.load(),o(e,t)}async function o(e,t){const r=[],a=(...e)=>{for(const t of e)null!=t&&(Array.isArray(t)?a(...t):s.A.isCollection(t)?t.forEach(e=>a(e)):(0,i.Zm)(t)&&r.push(t))};t(a);let o=null;if(await(0,n.Tj)(r,async e=>{const t=await(0,n.Ke)(function(e){return"loadAll"in e&&"function"==typeof e.loadAll}(e)?e.loadAll():e.load());!1!==t.ok||o||(o=t)}),o)throw o.error;return e}},83116:(e,t,r)=>{r.d(t,{default:()=>O});var n=r(31635),s=r(92602),i=r(11254),a=r(7762),o=r(62885),l=r(25482),u=r(4718),c=r(92474),p=r(81583),d=r(53966),y=r(97768),h=r(74887),g=r(84952),f=r(91429),m=r(16930),b=r(20655),w=r(80812),v=r(43281),L=r(69622),C=r(73444),A=r(10838);let M=class extends L.A{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let t="local"===e||"global"===e?e:(0,A.xO)(e??(0,C.JK)())??"global";return t="no"===t?"nb":t,t}};(0,n.Cg)([(0,f.MZ)()],M.prototype,"apiKey",void 0),(0,n.Cg)([(0,f.MZ)()],M.prototype,"id",void 0),(0,n.Cg)([(0,f.MZ)()],M.prototype,"language",void 0),(0,n.Cg)([(0,f.MZ)()],M.prototype,"places",void 0),(0,n.Cg)([(0,f.MZ)()],M.prototype,"serviceUrl",void 0),(0,n.Cg)([(0,f.MZ)()],M.prototype,"worldview",void 0),M=(0,n.Cg)([(0,f.$K)("esri.support.BasemapStyle")],M);const S=M;var I,T,_=r(16215),Z=r(751),x=r(43937);let E=class extends((0,l.T)(c.x_)){static{I=_.Y}static{T=this}constructor(e){super(e),this[I]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+T.idCounter++,this.baseLayers=new a.A,this.referenceLayers=new a.A,this.groundLayers=new a.A;const t=e=>{const{parent:t}=e;t&&t!==this&&"remove"in t&&t.remove?.(e),e.parent=this,"elevation"!==e.type&&"integrated-mesh-3dtiles"!==e.type||d.A.getLogger(this).error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=e=>{const{parent:t}=e;t&&t!==this&&"remove"in t&&t.remove?.(e),e.parent=this},n=e=>{e.parent=null},s=e=>{e.parent===this&&(e.parent=null)};this.addHandles([this.baseLayers.on("after-add",e=>t(e.item)),this.baseLayers.on("after-remove",e=>n(e.item)),this.referenceLayers.on("after-add",e=>t(e.item)),this.referenceLayers.on("after-remove",e=>n(e.item)),this.groundLayers.on("before-add",e=>{const t=e.item;return t.parent===this?(d.A.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' already a ground layer, second add will be ignored.`),void e.preventDefault()):"integrated-mesh-3dtiles"!==t.type?(d.A.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored.`),void e.preventDefault()):void 0}),this.groundLayers.on("after-add",e=>r(e.item)),this.groundLayers.on("after-remove",e=>s(e.item))])}static{this.idCounter=0}initialize(){this.when().catch(e=>{d.A.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const t of e)t.destroyed||t.destroy();const t=this.groundLayers.toArray();for(const e of t)e.destroyed||e.destroy();const r=this.referenceLayers.toArray();for(const e of r)e.destroyed||e.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=(0,y.pR)(this.portalItem)}removeChildLayer(e){for(const t of[this.baseLayers,this.referenceLayers,this.groundLayers])t.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}get baseLayers(){return this._get("baseLayers")}set baseLayers(e){this._set("baseLayers",(0,o.V)(e,this._get("baseLayers")))}_writeBaseLayers(e,t,r){const n=[];e?(r={...r,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(e=>{const t=(0,Z.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&n.push(t)}),this.referenceLayers.forEach(e=>{const t=(0,Z.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&("scene"!==e.type&&(t.isReference=!0),n.push(t))}),t.baseMapLayers=n):t.baseMapLayers=n}set groundLayers(e){this._set("groundLayers",(0,o.V)(e,this._get("groundLayers")))}_writeGroundLayers(e,t,r){const n=[];e&&(r={...r,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(e=>{const t=(0,Z.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&n.push(t)}),n.length>0&&(t.groundLayers=n))}get loaded(){return super.loaded}get referenceLayers(){return this._get("referenceLayers")}set referenceLayers(e){this._set("referenceLayers",(0,o.V)(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return(0,p.g)(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>(0,u.Nb)(e)?e.clone():e),groundLayers:this.groundLayers.map(e=>(0,u.Nb)(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>(0,u.Nb)(e)?e.clone():e)};return this.loaded&&(e.loadStatus="loaded"),new T({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){return e=e||{},t?.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(e=>{const t=(0,u.o8)(e);return t.url&&(0,g.BQ)(t.url)&&(t.url=`https:${t.url}`),t.templateUrl&&(0,g.BQ)(t.templateUrl)&&(t.templateUrl=`https:${t.templateUrl}`),t})),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:r,style:n}=this;(0,h.Te)(e);const s=[];if(t){const r=t.context?t.context.url:null;if(s.push(this._loadLayersFromJSON(t.data,r,e)),t.data.id&&!t.data.title){const e=t.data.id;s.push((0,v.q)(e).then(e=>{e&&this.read({title:e},t.context)}))}}else r?s.push(this._loadFromItem(r,e)):n&&s.push(this._loadFromStylesService(n,e));await Promise.all(s)}async _loadLayersFromJSON(e,t,n){const s=this.resourceInfo?.context,i=this.portalItem?.portal||s?.portal||null,a=D[s?.origin||""]??"web-map",{populateOperationalLayers:o}=await Promise.all([r.e(5613),r.e(9933)]).then(r.bind(r,75356)),l=[];if((0,h.Te)(n),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const r={context:{...s,origin:a,url:t,portal:i,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},n=e=>"web-scene"===a&&"ArcGISSceneServiceLayer"===e.layerType||e.isReference,u=o(this.baseLayers,e.baseMapLayers.filter(e=>!n(e)),r);l.push(u);const c=o(this.referenceLayers,e.baseMapLayers.filter(n),r);l.push(c)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const r={context:{...s,origin:a,url:t,portal:i,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},n=o(this.groundLayers,e.groundLayers,r);l.push(n)}await Promise.allSettled(l)}async _loadFromItem(e,t){const r=await e.load(t),n=await r.fetchData("json",t),s=(0,g.An)(e.itemUrl??"");return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:U[e.type||""]??"web-map",portal:e.portal||b.A.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||b.A.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,t)}async _loadFromStylesService(e,t){const r=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,n=`${r}/styles/${e.id}/self`,a=`${r}/webmaps/${e.id}`,o=e.apiKey??s.A.apiKeys.basemapStyles,[l,u]=await Promise.all([(await(0,i.A)(n,{query:{token:o},signal:t?.signal})).data,(await(0,i.A)(a,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:t?.signal})).data]);this.thumbnailUrl??=l.thumbnailUrl;const c=(0,g.An)(a);if(this._set("resourceInfo",{data:u.baseMap??{},context:{origin:"web-map",url:c}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:u.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,c,t),o)for(const e of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in e&&(e.apiKey=o)}static fromId(e){const t=v.H[e];return t?t.itemId?new T({portalItem:{id:t.itemId,portal:{url:"https://www.arcgis.com"}}}):T.fromJSON(t,t.is3d?{origin:"web-scene",portal:new b.A({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}};(0,n.Cg)([(0,f.MZ)({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,r,n){this._writeBaseLayers(e,t,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:a.A}},writer(e,t,r,n){this._writeBaseLayers(e,t,n)}}}}}})],E.prototype,"baseLayers",null),(0,n.Cg)([(0,f.MZ)({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(e,t,r,n){this._writeGroundLayers(e,t,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:a.A}},writer(e,t,r,n){this._writeGroundLayers(e,t,n)}}}}}})],E.prototype,"groundLayers",null),(0,n.Cg)([(0,f.MZ)({type:String,json:{origins:{"web-scene":{write:!0}}}})],E.prototype,"id",void 0),(0,n.Cg)([(0,f.MZ)({type:w.default})],E.prototype,"portalItem",void 0),(0,n.Cg)([(0,f.MZ)()],E.prototype,"referenceLayers",null),(0,n.Cg)([(0,f.MZ)({readOnly:!0})],E.prototype,"resourceInfo",void 0),(0,n.Cg)([(0,f.MZ)({type:m.A})],E.prototype,"spatialReference",void 0),(0,n.Cg)([(0,f.MZ)({type:S})],E.prototype,"style",void 0),(0,n.Cg)([(0,f.MZ)()],E.prototype,"thumbnailUrl",void 0),(0,n.Cg)([(0,f.MZ)({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],E.prototype,"title",void 0),(0,n.Cg)([(0,x.K)("title")],E.prototype,"writeTitle",null),E=T=(0,n.Cg)([(0,f.$K)("esri.Basemap")],E);const U={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},D={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},O=E}}]);