const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./lclayout-BKmmdaIb.js","./_commonjsHelpers-DCkdB7M8.js"])))=>i.map(i=>d[i]);
import{ae as Ie,pN as de,a as Z,a7 as ht,ej as Y,aX as St,_ as Lt,g7 as Mt,fA as mt,aJ as h,aK as m,aL as ve,db as ft,aF as gt,aI as le,cK as kt,fR as Ee,gC as ie,g0 as he,ax as _e,r6 as qe,dl as bt,ku as wt,m8 as Dt,m9 as Ct,kv as Tt,mw as Ft,ri as xt,d3 as Pe,h$ as Rt,mo as pe,rj as me,ld as fe,of as Ge,hI as At,nA as It,mv as Et,bi as jt,me as Ot,mf as qt,mg as Pt,fF as Gt,md as Ut,hn as Ht,fG as zt,h8 as Qt,g$ as Wt,rk as Bt,eb as we,gW as ue,mi as Vt,kw as Jt,fr as Ue,mk as Zt,b0 as Kt,mj as Yt,dk as Xt,aM as en,a$ as V,rl as tn,rm as nn,rn,p3 as an,fH as sn,ro as on,rp as ln,ha as pn,mJ as dn,mK as un,mq as cn,rq as yn,mr as hn,fs as mn,ms as fn,o5 as gn,e1 as bn,qb as wn,mp as Tn,fJ as In}from"./index-C_bK48d2.js";import{s as En}from"./OptimizedGeometry-KE6YknPZ.js";import{i as xe,r as _n,n as Re,c as oe,h as $n,X as Nn}from"./knowledgeGraphService-CGFZ1iJy.js";import{I as $e,t as Ne,_ as H,E as ge,S as Ae,o as De}from"./constants-SxxbBSOD.js";import{H as vn}from"./featureConversionUtils-Di1UhLmY.js";import{o as Sn}from"./OptimizedFeatureSet-BZnZXZq6.js";import"./GraphicsLayer-CFgfYbpT.js";import{i as ae,p as He,s as ze}from"./Relationship-njbOqBuZ.js";import{f as Ln}from"./FeatureStore-aqcGTsJW.js";import{W as Mn}from"./QueryEngine-DN0KvbO9.js";import{u as Qe}from"./clientSideDefaults-C_rk6q2f.js";import{t as kn,s as Dn}from"./QueryEngineCapabilities-zq1XKmMU.js";import{L as We}from"./utils-B2fTWpox.js";let Cn=class{constructor(){this.version="",this.queryResult=new Fn}},Fn=class{constructor(){this.featureResult=new xn}},xn=class{constructor(){this.objectIdFieldName="",this.uniqueIdField=new Rn,this.globalIdFieldName="",this.geohashFieldName="",this.geometryProperties=new An,this.geometryType=null,this.spatialReference=new Ie,this.exceededTransferLimit=!1,this.hasZ=!1,this.hasM=!1,this.transform=new _t,this.fields=[],this.fieldNameToAttributeIndexMap={},this.values=[],this.features=[],this.geometryFields=[]}},Rn=class{constructor(){this.name="",this.isSystemMaintained=!1}},An=class{constructor(){this.shapeAreaFieldName="",this.shapeLengthFieldName="",this.units=""}},_t=class{constructor(){this.quantizeOriginPosition="upperLeft",this.scale=new jn,this.translate=new On}},jn=class{constructor(){this.xScale=0,this.yScale=0,this.mScale=0,this.zScale=0}},On=class{constructor(){this.xTranslate=0,this.yTranslate=0,this.mTranslate=0,this.zTranslate=0}},qn=class{constructor(){this.name="",this.fieldType="esriFieldTypeString",this.alias="",this.sqlType="sqlTypeVarchar",this.domain="",this.defaultValue=""}},Pn=class{constructor(){this.attributes=[],this.compressedGeometry=new Ce,this.centroid=new Ce,this.aggregateGeometries=[]}},Ce=class{constructor(){this.geometryType=null,this.lengths=[],this.coords=[]}};const Gn=["ELEMENTUID","TYPENAME"],Un={upperLeft:0,lowerLeft:1},Hn={sqlTypeBigInt:0,sqlTypeBinary:1,sqlTypeBit:2,sqlTypeChar:3,sqlTypeDate:4,sqlTypeDecimal:5,sqlTypeDouble:6,sqlTypeFloat:7,sqlTypeGeometry:8,sqlTypeGUID:9,sqlTypeInteger:10,sqlTypeLongNVarchar:11,sqlTypeLongVarbinary:12,sqlTypeLongVarchar:13,sqlTypeNChar:14,sqlTypeNVarChar:15,sqlTypeOther:16,sqlTypeReal:17,sqlTypeSmallInt:18,sqlTypeSqlXml:19,sqlTypeTime:20,sqlTypeTimestamp:21,sqlTypeTimestamp2:22,sqlTypeTinyInt:23,sqlTypeVarbinary:24,sqlTypeVarchar:25};function zn(e){const t=new Cn;t.version=e.version;const n=e.get_query_result();if(n.results_type.value!==0)throw new Error("Got a non-feature collection type");const i=n.get_feature_result(),r=t.queryResult.featureResult;r.objectIdFieldName=i.objectid_field_name,r.exceededTransferLimit=i.exceeded_transfer_limit,r.hasM=i.has_m,r.hasZ=i.has_z,r.geometryType=de(xe,i.geometry_type.value),r.globalIdFieldName=i.globalid_field_name,r.geohashFieldName=i.geohash_field_name;const a=r.uniqueIdField,s=i.unique_id_field;a.name=s.name,a.isSystemMaintained=s.isSystemMaintained;const o=r.geometryProperties,d=i.geometry_properties;o.shapeAreaFieldName=d.shapeAreaFieldName,o.shapeLengthFieldName=d.shapeLengthFieldName,o.units=d.units;const c=r.spatialReference,y=i.spatial_reference;c.wkid=y.wkid,c.latestWkid=y.latestWkid,c.vcsWkid=y.vcsWkid,c.latestVcsWkid=y.latestVcsWkid,c.wkt=y.wkt,r.transform=Wn(i.transform);const l=r.fields,p=r.fieldNameToAttributeIndexMap,u=i.fields,b=u.size();for(let _=0;_<b;_++){const k=u.get(_),I=$t(k);l.push(I),p[I.name]=_,k.delete()}u.delete();const v=r.values,$=i.values_count();for(let _=0;_<$;_++)v.push(i.get_value_at(_));const R=r.features,f=i.features,N=f.size();if(N>0){for(const _ of Gn)if(p[_]===void 0)throw new Error(`Feature collection missing required attribute: ${_}`)}for(let _=0;_<N;_++){const k=new Pn,I=f.get(_),q=k.attributes,G=I.attributes_count();for(let P=0;P<G;P++)q.push(I.get_attribute_at(P));const j=I.get_compressed_geometry();j&&(k.compressedGeometry=Le(j),k.centroid=Le(I.get_centroid()));const z=k.aggregateGeometries,U=I.aggregate_geometries,te=U.size();for(let P=0;P<te;P++){const E=U.get(P),w=Le(E);z.push(w),E.delete()}U.delete(),R.push(k),I.delete()}f.delete();const A=r.geometryFields,C=i.geometry_fields,L=C.size();for(let _=0;_<L;_++){const k=C.get(_),I=Qn(k);A.push(I),k.delete()}return C.delete(),t}function Le(e){const t=new Ce;t.geometryType=de(xe,e.geometry_type.value);const n=[],i=[];for(let r=0;r<e.lengths.length;r++)n.push(e.lengths[r]);for(let r=0;r<e.coords.length;r++)i.push(e.coords[r]);return t.lengths=n,t.coords=i,t}function $t(e){const t=new qn;return t.name=e.name,t.alias=e.alias,t.fieldType=de(_n,e.field_type.value),t.sqlType=de(Hn,e.sql_type.value),t.domain=e.domain,t.defaultValue=e.default_value,t}function Qn(e){const t=$t(e);return t.geometryType=de(xe,e.geometry_type.value),t}function Wn(e){const t=new _t;t.quantizeOriginPosition=de(Un,e.quantizeOriginPosition.value);const n=t.scale,i=e.scale;n.xScale=i.xScale,n.yScale=i.yScale,n.mScale=i.mScale,n.zScale=i.zScale;const r=t.translate,a=e.translate;return r.xTranslate=a.xTranslate,r.yTranslate=a.yTranslate,r.mTranslate=a.mTranslate,r.zTranslate=a.zTranslate,t}async function Bn(e,t){const n=[],i={generateAllSublayers:!1,namedTypeDefinitions:new Map};return e.entitiesUrl&&n.push(Be(e.entitiesUrl,t).then(r=>{Ve(r,i)})),e.relationshipsUrl&&n.push(Be(e.relationshipsUrl,t).then(r=>{Ve(r,i)})),await Promise.all(n),i}async function Yi(e,t,n){t??(t=!1);const i={generateAllSublayers:t,namedTypeDefinitions:new Map};return await Zn(e,n).then(r=>{Yn(r,i)}),i}async function Xi(e){const t=await Re(),n=new t.MapOfObjectIdentifierSets;Vn(n,t,e);const i=new t.MapOfObjectIdentifierSetsEncoder;try{i.set_map_of_identifier_sets(n),i.encode();const r=i.get_encoding_result();if(r.error.error_code!==0)throw new Z("knowledge-graph:layer-support-utils",r.error.error_message);const a=structuredClone(r.get_byte_buffer());return i.delete(),a}finally{n.delete()}}function Vn(e,t,n){for(const[i,r]of n.namedTypeDefinitions){if(!r.members||r.useAllData)continue;const a=r.members.keys();let s=!1,o=!0;const d=new t.ObjectIdArray,c=new t.StringArray,y=new t.GlobalIdArray,l=new t.IdentifierArray,p=new t.ObjectIdentifierSet;for(const u of a)o&&(s=!isNaN(Number(u)),o=!1),s?d.add_objectid(Number(u)):(c.add_string(u),y.add_globalid(u)),l.add_identifier(u);p.set_oid_array(d),p.set_string_array(c),p.set_globalid_array(y),p.set_identifier_array(l),d.delete(),c.delete(),y.delete(),l.delete(),e.put_identifier_set(i,p),p.delete()}return e}async function Be(e,t){const n=await ht(e,{responseType:"array-buffer",signal:t==null?void 0:t.signal});return Jn(await n.data)}async function Jn(e){const t=new(await Re()).FeatureCollectionDecoder,n=t.decode(new Uint8Array(e));if(n.error_code!==0)throw new Z("knowledge-graph:layer-support-utils",n.error_message);const i=t.get_feature_collection(),r=zn(i);return t.delete(),r}async function Zn(e,t){const n=await ht(e,{responseType:"array-buffer",signal:t==null?void 0:t.signal}),i=await n.data;return Kn(new Uint8Array(i))}async function Kn(e){const t=new(await Re()).MapOfObjectIdentifierSetsDecoder,n=t.decode(new Uint8Array(e)),i=new Map;if(n.error_code!==0)throw new Z("knowledge-graph:layer-support-utils",n.error_message);const r=t.get_map_of_identifier_sets(),a=r.keys,s=a.size();for(let o=0;o<s;o++){const d=a.get(o),c=r.query_identifier_set(d),y=[];if(c.id_array_type.value===1){const l=c.get_globalid_array(),p=l.count();for(let u=0;u<p;u++)y.push(l.get_globalid_at(u))}else if(c.id_array_type.value===3){const l=c.get_identifier_array(),p=l.count();for(let u=0;u<p;u++)y.push(l.get_identifier_at(u).toString())}else if(c.id_array_type.value===2){const l=c.get_string_array(),p=l.count();for(let u=0;u<p;u++)y.push(l.get_string_at(u))}else{if(c.id_array_type.value!==0)throw new Z("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const l=c.get_oid_array(),p=l.count();for(let u=0;u<p;u++)y.push(l.get_objectid_at(u).toString())}}i.set(d,y)}return t.delete(),i}function Ve(e,t){var a,s,o;if(!((a=e==null?void 0:e.queryResult)!=null&&a.featureResult))return t;const{hasZ:n,hasM:i}=e.queryResult.featureResult,r=e.queryResult.featureResult.fieldNameToAttributeIndexMap;for(const d of e.queryResult.featureResult.features){const c=d.attributes[r.TYPENAME],y=Y(t.namedTypeDefinitions,c,()=>({useAllData:!1,members:new Map})),l=d.attributes[r.ELEMENTUID];if(((o=(s=d.compressedGeometry)==null?void 0:s.coords)==null?void 0:o.length)>0){let p=d.compressedGeometry.lengths;d.compressedGeometry.geometryType==="esriGeometryPoint"&&(p=[]),y.members.set(l,{id:l,linkChartLocation:new En(p,d.compressedGeometry.coords,n,i)})}else y.members.set(l,{id:l})}return t}function Yn(e,t){for(const[n,i]of e){const r=Y(t.namedTypeDefinitions,n,()=>({useAllData:!1,members:new Map}));for(const a of i)r.members.has(a)||r.members.set(a,{id:a})}return t}const er={fetchAndConvertSerializedLinkChart:(e,t)=>Bn(e,t)},Fe=(e,t)=>{if(e.type==="column-reference")return e.column===t.systemOidFieldName?"ID(n)":`n.${e.column}`;if(e.type==="string")return`'${e.value}'`;if(e.type==="number")return`${e.value}`;if(e.type==="binary-expression"&&t.supportedSqlTypes.has(e.left.type)&&t.supportedSqlTypes.has(e.right.type)&&t.supportedSqlOperators.has(e.operator))return`${Fe(e.left,t)} ${e.operator} ${Fe(e.right,t)}`;if(e.type==="binary-expression"&&e.operator==="LIKE"){let n="";if(e.left.type==="function"&&e.left.args.value[0].type==="column-reference")n+=`lower(n.${e.left.args.value[0].column})`;else{if(e.left.type!=="column-reference")return t.unsupportedOperationFound=!0,"";n+=`lower(n.${e.left.column})`}if(n+=" CONTAINS (",e.right.type!=="string")return t.unsupportedOperationFound=!0,"";{let i=e.right.value;i.startsWith("%")&&(i=i.slice(1)),i.endsWith("%")&&(i=i.slice(0,-1)),n+=`'${i.toLowerCase()}')`}return n}return t.unsupportedOperationFound=!0,""};let Me=class se{constructor(){this._featureLookup=new Map}static getInstance(){return se.instance||(se.instance=new se),se.instance}static resetInstance(){se.instance&&(se.instance=null)}deleteFromStore(t){t.forEach(n=>{this._featureLookup.delete(n)})}readFromStoreByList(t){const n=[];return t.forEach(i=>{const r=this.readFromStoreById(i);r&&n.push(r)}),n}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,n,i){const r=[];return t.forEach(a=>{if(!(a!=null&&a.id))return;a.properties||(a.properties=[]);let s=null;i&&a.properties[i]&&(s=vn(a.properties[i])),"originId"in a&&"destinationId"in a&&(a.properties[$e]=a.originId,a.properties[Ne]=a.destinationId),a.properties[n]=a.id;let o=a.properties;if(a.id){const c=this._featureLookup.get(a.id);if(c!=null&&c.attributes){o={...c.attributes,...o};const y=i&&o[i];y!=null&&(o[i]=St(y)),s=s??c.geometry}}const d=new Sn(s==null?void 0:s.clone(),o,null,a.id);this._featureLookup.set(`${a.typeName?`${a.typeName}__${a.id}`:a.id}`,d),r.push(d)}),r}},ke,T=null;function tr(){return ke||(ke=Lt(()=>import("./lclayout-BKmmdaIb.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>e.l).then(({default:e})=>e({locateFile:t=>Mt(`esri/libs/linkchartlayout/${t}`)})).then(e=>{Xn(e)}),ke)}function Xn(e){T=e}const Je={right:0,left:1,top:2,bottom:3},Ze={none:0,"start-only":1,"start-and-end":2};function ei(e){const t={timeDirection:"right",timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:"start-and-end",showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0,...e==null?void 0:e.toJSON(),eventsTicksVisualization:(e==null?void 0:e.eventsTicksVisualization)??"start-and-end"};return{...t,timeDirection:{value:Je[t.timeDirection]??Je.right},eventsTicksVisualization:{value:Ze[t.eventsTicksVisualization]??Ze["start-and-end"]}}}function re(e,t,n,i,r,a){const s=n.length,o=r.length,d=Float64Array.BYTES_PER_ELEMENT,c=Uint32Array.BYTES_PER_ELEMENT,y=Uint8Array.BYTES_PER_ELEMENT,l=16,p=l+s*(y+2*d)+o*(2*c),u=T._malloc(p);try{const b=u+l-u%l,v=b+s*d,$=v+s*d,R=$+o*c,f=R+o*c,N=()=>[T.HEAPF64.subarray(b>>3,(b>>3)+s),T.HEAPF64.subarray(v>>3,(v>>3)+s),T.HEAPU32.subarray($>>2,($>>2)+o),T.HEAPU32.subarray(R>>2,(R>>2)+o),T.HEAPU8.subarray(f,f+s)],[A,C,L,_,k]=N();A.set(n),C.set(i),L.set(r),_.set(a),k.set(t);const I=e(s,f,b,v,o,$,R);let q=null,G=null;if(I.value===0){const E=T.getLayoutLinksTypes(),w=T.getLayoutLinksVerticesEndIndices(),F=T.getLayoutLinksVertices(),x=T.countLayoutLinksVertices();!o||E&&w?x&&!F?I.value=1:(q={types:new Uint8Array(T.HEAPU8.subarray(E,E+o)),vertexEndIndex:new Uint32Array(T.HEAPU32.subarray(w>>2,(w>>2)+o)),vertices:new Float64Array(T.HEAPF64.subarray(F>>3,(F>>3)+2*x))},G=T.getAuxiliaryGraphicElements()):I.value=1}const[j,z,U,te,P]=N();return n.set(j),i.set(z),r.set(U),a.set(te),t.set(P),{status:I.value,links:q,graphics:G}}finally{T._free(u),T.cleanupLayout()}}const Ke=2,Ye=1,Xe=-1;var et,tt,nt,it,rt,at,st;(function(e){function t(){return T.getMinIdealEdgeLength()}function n(i,r,a,s,o,d,c=Ke,y=Ye,l=Xe){return re((p,u,b,v,$,R,f)=>T.applyForceDirectedLayout(i,p,u,b,v,$,R,f,c,y,l),r,a,s,o,d)}e.getMinIdealEdgeLength=t,e.apply=n})(et||(et={})),function(e){function t(n,i,r,a,s,o,d=Ke,c=Ye,y=Xe){return re((l,p,u,b,v,$,R)=>T.applyCommunityLayout(n,l,p,u,b,v,$,R,d,c,y),i,r,a,s,o)}e.apply=t}(tt||(tt={})),function(e){function t(n,i,r,a,s,o){return re((d,c,y,l,p,u,b)=>T.applySimpleLayout(n,d,c,y,l,p,u,b),i,r,a,s,o)}e.apply=t}(nt||(nt={})),function(e){function t(n,i,r,a,s,o){return re((d,c,y,l,p,u,b)=>T.applyHierarchicalLayout(n,d,c,y,l,p,u,b),i,r,a,s,o)}e.apply=t}(it||(it={})),function(e){function t(n,i,r,a,s,o){return re((d,c,y,l,p,u,b)=>T.applyRadialTreeLayout(n,d,c,y,l,p,u,b),i,r,a,s,o)}e.apply=t}(rt||(rt={})),function(e){function t(n,i,r,a,s,o){return re((d,c,y,l,p,u,b)=>T.applySmartTreeLayout(n,d,c,y,l,p,u,b),i,r,a,s,o)}e.apply=t}(at||(at={})),function(e){function t(n,i,r,a,s,o,d,c,y,l,p,u){return re((b,v,$,R,f,N,A)=>{if(s.length!==b)return{value:1};if(o.length!==b)return{value:1};if(y.length!==f)return{value:1};if(l.length!==f)return{value:1};const C=Float64Array.BYTES_PER_ELEMENT,L=16,_=T._malloc(L+b*C),k=T._malloc(L+b*C),I=T._malloc(L+f*C),q=T._malloc(L+f*C),G=_+L-_%L,j=k+L-k%L,z=I+L-I%L,U=q+L-q%L;try{return T.HEAPF64.subarray(G>>3,(G>>3)+b).set(s),T.HEAPF64.subarray(j>>3,(j>>3)+b).set(o),T.HEAPF64.subarray(z>>3,(z>>3)+f).set(y),T.HEAPF64.subarray(U>>3,(U>>3)+f).set(l),T.applyChronologicalLayout(n,b,v,$,R,G,j,f,N,A,z,U,p,ei(u))}finally{T._free(_),T._free(k),T._free(I),T._free(q)}},i,r,a,d,c)}e.apply=t}(st||(st={}));mt()({none:"none",startAndEnd:"start-and-end",startOnly:"start-only"});mt()({absoluteValue:"absolute-value",multiplier:"multiplier"});const ti=new Map([["basic-grid","basic-grid"],["geographic-organic-standard","geographic-organic-standard"],["hierarchical-bottom-to-top","hierarchical-bottom-to-top"],["hierarchical-top-to-bottom","hierarchical-bottom-to-top"],["organic-community","organic-community"],["organic-fusiform","organic-standard"],["organic-leaf-circle","organic-standard"],["organic-standard","organic-standard"],["radial-node-centric","radial-root-centric"],["radial-root-centric","radial-root-centric"],["tree-bottom-to-top","tree-left-to-right"],["tree-left-to-right","tree-left-to-right"],["tree-right-to-left","tree-left-to-right"],["tree-top-to-bottom","tree-left-to-right"],["chronological-mono-timeline","chronological-mono-timeline"],["chronological-multi-timeline","chronological-multi-timeline"]]);function ni(e,t){var i,r;const n=new Map;if((i=t.dataModel)!=null&&i.relationshipTypes)for(const a of t.dataModel.relationshipTypes)a.name&&n.set(a.name,[]);for(const a of e)n.has(a.typeName)&&((r=n.get(a.typeName))==null||r.push(a.id));return n}async function nr(e,t,n){const i=[],r=ni(e,t),a={},s=[];for(const[y,l]of r){if(l.length<1)continue;const p=`${y}_ids`;a[p]=l,s.push(`MATCH (n)-[r:${y}]->(m) WHERE id(r) in $${p} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`)}if(s.length===0)return[];const o=s.join(" UNION "),d=new ae({openCypherQuery:o,bindParameters:a}),c=(await oe(t,d,n==null?void 0:n.requestOptions)).resultRowsStream.getReader();for(;;){const{done:y,value:l}=await c.read();if(y)break;for(const p of l)i.push({id:p[0],typeName:p[1]}),i.push({id:p[2],typeName:p[3]})}return i}const ir=e=>ti.get(e)??"radial-root-centric";function ii(e){if(!e.spatialReference.isWGS84)throw new Z("knowledge-graph:layer-support-utils","The utilsExtentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}let K=class extends ft{constructor(t){var i,r,a;super(t),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const n=new Map;(i=t.knowledgeGraph.dataModel.entityTypes)==null||i.forEach(s=>{var o,d;s.name&&(n.set(s.name,"entity"),this._processingCacheUpdatesLookup.set(s.name,[]),t.inclusionModeDefinition&&!((o=t.inclusionModeDefinition)!=null&&o.generateAllSublayers)||this.entityTypeNames.add(s.name),(d=s.properties)==null||d.forEach(c=>{c.geometryType&&c.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(s.name,{name:c.name??"",geometryType:c.geometryType})}))}),(r=t.knowledgeGraph.dataModel.relationshipTypes)==null||r.forEach(s=>{var o,d;s.name&&(n.set(s.name,"relationship"),this._processingCacheUpdatesLookup.set(s.name,[]),t.inclusionModeDefinition&&!((o=t.inclusionModeDefinition)!=null&&o.generateAllSublayers)||this.relationshipTypeNames.add(s.name),(d=s.properties)==null||d.forEach(c=>{c.geometryType&&c.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(s.name,{name:c.name??"",geometryType:c.geometryType})}))}),(a=t.inclusionModeDefinition)==null||a.namedTypeDefinitions.forEach((s,o)=>{var c,y;if(n.get(o)==="entity")this.entityTypeNames.add(o);else{if(n.get(o)!=="relationship")return gt.getLogger(this).warn(`A named type, ${o}, was in the inclusion list that wasn't in the data model and will be removed`),void((c=t.inclusionModeDefinition)==null?void 0:c.namedTypeDefinitions.delete(o));this.relationshipTypeNames.add(o)}const d=new Map;(y=s.members)==null||y.forEach(l=>{Y(this.memberIdTypeLookup,l.id,()=>new Set).add(o)}),this.sublayerCaches.set(o,d)})}addToLayer(t){t.forEach(({typeName:n,id:i})=>{if(!this.inclusionModeDefinition)throw new Z("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(n)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(n)){const r=this.inclusionModeDefinition.namedTypeDefinitions.get(n);r.members||(r.members=new Map),r.members.set(i,{id:i}),Y(this.memberIdTypeLookup,i,()=>new Set).add(n)}}else{const r=new Map;r.set(i,{id:i}),this.inclusionModeDefinition.namedTypeDefinitions.set(n,{useAllData:!1,members:r}),Y(this.memberIdTypeLookup,i,()=>new Set).add(n)}})}getById(t){return Me.getInstance().readFromStoreById(t)}async getData(t,n,i){var a,s;if(n.objectType.name&&((a=this.inclusionModeDefinition)!=null&&a.namedTypeDefinitions)&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(n.objectType.name))return[];let r;if(r=t||new le({where:"1=1",outFields:["*"]}),n.parentCompositeLayer.type==="link-chart"){const o=n.parentCompositeLayer,d=this._processingCacheUpdatesLookup.get(n.objectType.name??""),c=r.outFields;c&&c.length===1&&c[0]===H&&r.where==="1=1"||await Promise.all(d??[]);const y=this.sublayerCaches.has(n.objectType.name??"")?Array.from((s=this.sublayerCaches.get(n.objectType.name))==null?void 0:s.values()):[],l=[];return y.forEach(p=>{if(this.relationshipTypeNames.has(n.objectType.name)){p.geometry=o.relationshipLinkChartDiagramLookup.get(p.attributes[n.objectIdField]);const u=this.memberIdTypeLookup.get(p.attributes[$e]),b=this.memberIdTypeLookup.get(p.attributes[Ne]),v=this._isEndEntitySpatial(u,p,$e),$=this._isEndEntitySpatial(b,p,Ne);p.attributes[ge]=Number(v&&$)}else{p.geometry=o.entityLinkChartDiagramLookup.get(p.attributes[n.objectIdField]);const u=this.geographicLookup.get(n.objectType.name);u&&p.attributes[u.name]?p.attributes[ge]=1:p.attributes[ge]=0}p.attributes[Ae]=p.geometry,l.push(p)}),l}return this.retrieveDataFromService(r,n,i)}async getConnectedRecordIds(t,n,i){const r=[];let a="";const s=this._getNamedTypeIdMapFromNodeIds(t);if(n&&(n==null?void 0:n.length)!==0){for(const l of n)a=a+l+"|";a=a.slice(0,-1)}const o={},d=[];for(const[l,p]of s){const u=`${l}_ids`;o[u]=p,n&&(n==null?void 0:n.length)!==0?d.push(`MATCH (n:${l}) WHERE id(n) IN $${u} WITH n MATCH (n)-[r:${a}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`):d.push(`MATCH (n:${l}) WHERE id(n) IN $${u} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`)}if(!d.length)return r;const c=d.join(" UNION "),y=(await oe(this.knowledgeGraph,new ae({openCypherQuery:c,bindParameters:o}),{signal:i==null?void 0:i.signal})).resultRowsStream.getReader();for(;;){const{done:l,value:p}=await y.read();if(l)break;for(let u=0;u<p.length;u++){const b=p[u];r.push({id:b[0],typeName:b[1]}),r.push({id:b[2],typeName:b[3]})}}return r}async getRelationshipsBetweenNodes(t,n,i){const r=this._getNamedTypeIdMapFromNodeIds(t);if(r.size===0)return[];const a={relationshipExclusionIds:n,possibleConnectionEntityIds:t},s=[];for(const[y,l]of r.entries()){const p=`${y}_ids`;a[p]=l,s.push(`MATCH (n:${y}) WHERE id(n) IN $${p} WITH n MATCH (n)-[r]->(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const o=s.join(" UNION "),d=[],c=(await oe(this.knowledgeGraph,new ae({openCypherQuery:o,bindParameters:a}),{signal:i==null?void 0:i.signal})).resultRowsStream.getReader();for(;;){const{done:y,value:l}=await c.read();if(y)break;for(let p=0;p<l.length;p++){const u=l[p];d.push({id:u[0],typeName:u[1]})}}return d}async getRelationshipsFromNodes(t,n,i,r){const a=this._getNamedTypeIdMapFromNodeIds(t);if(a.size===0||n.length===0)return[];const s={relationshipExclusionIds:i,possibleConnectionEntityIds:n},o=[];for(const[p,u]of a.entries()){const b=`${p}_ids`;s[b]=u,o.push(`MATCH (n:${p}) WHERE id(n) IN $${b} WITH n MATCH (n)-[r]-(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const d=o.join(" UNION "),c=new Map,y=(await oe(this.knowledgeGraph,new ae({openCypherQuery:d,bindParameters:s}),{signal:r==null?void 0:r.signal})).resultRowsStream.getReader();for(;;){const{done:p,value:u}=await y.read();if(p)break;for(let b=0;b<u.length;b++){const v=u[b];let $=c.get(v[1]);$||($=new Set,c.set(v[1],$)),$.add(v[0])}}const l=[];for(const[p,u]of c)for(const b of u)l.push({id:b,typeName:p});return l}async refreshCacheContent(t,n,i,r=!0,a){var y,l,p,u,b,v,$,R;const s=Me.getInstance(),o=[],d=new Map,c=new Map;(y=this.knowledgeGraph.dataModel.entityTypes)==null||y.forEach(f=>{f.name&&c.set(f.name,f)}),(l=this.knowledgeGraph.dataModel.relationshipTypes)==null||l.forEach(f=>{f.name&&c.set(f.name,f)}),t||this.inclusionModeDefinition?t?t.forEach(f=>{var N;if(this.memberIdTypeLookup.has(f))for(const A of this.memberIdTypeLookup.get(f))d.has(A)?(N=d.get(A))==null||N.push(f):d.set(A,[f])}):(u=(p=this.inclusionModeDefinition)==null?void 0:p.namedTypeDefinitions)==null||u.forEach((f,N)=>{f.useAllData?d.set(N,null):f.members&&f.members.forEach(A=>{var C;d.has(N)&&d.get(N)!==null?(C=d.get(N))==null||C.push(A.id):d.set(N,[A.id])})}):((b=this.knowledgeGraph.dataModel.entityTypes)==null||b.forEach(f=>{f.name&&d.set(f.name,null)}),(v=this.knowledgeGraph.dataModel.entityTypes)==null||v.forEach(f=>{f.name&&d.set(f.name,null)}));for(const[f,N]of d){const A=new Set(N),C=new Promise((L,_)=>{(async()=>{var P,E,w,F,x,O,M,Q,S;const I=new Set,q=[];let G,j="",z=!1;if(n||((E=(P=c.get(f))==null?void 0:P.properties)==null||E.forEach(D=>{D.name&&I.add(D.name)})),i&&this.geographicLookup.has(f)){const D=(w=this.geographicLookup.get(f))==null?void 0:w.name;D&&I.add(D)}if(this.entityTypeNames.has(f))j=`MATCH (n:${f}) ${N?"WHERE id(n) IN $ids ":""}return ID(n)`,I.forEach(D=>{j+=`, n.${D}`,q.push(D)});else{if(!this.relationshipTypeNames.has(f))throw new Z("knowledge-graph:layer-data-manager",`The graph type of ${f} could not be determined. Was this type set in the KG data model and inclusion definition?`);z=!0,j=`MATCH ()-[n:${f}]->() ${N?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,I.forEach(D=>{j+=`, n.${D}`,q.push(D)})}G=new ae(N?{openCypherQuery:j,bindParameters:{ids:N}}:{openCypherQuery:j});const U=(await oe(this.knowledgeGraph,G,{signal:a==null?void 0:a.signal})).resultRowsStream.getReader();for(;;){const{done:D,value:je}=await U.read();if(D)break;const Oe=[];for(let X=0;X<je.length;X++){const ne=je[X];let W=0,be=0;const B={properties:{}};for(B.id=ne[W],W++,be++,z&&(B.originId=ne[W],W++,be++,B.destinationId=ne[W],W++,be++,Y(this.nodeConnectionsLookup,B.originId,()=>new Set).add(B.id),Y(this.nodeConnectionsLookup,B.destinationId,()=>new Set).add(B.id),Y(this.relationshipConnectionsLookup,B.id,()=>[B.originId,B.destinationId]));W<ne.length;W++)B.properties[q[W-be]]=ne[W];A.delete(B.id),Oe.push(B)}const vt=s.writeToStore(Oe,H,(F=this.geographicLookup.get(f))==null?void 0:F.name);this.sublayerCaches.has(f)||this.sublayerCaches.set(f,new Map),r&&!((x=this.inclusionModeDefinition)!=null&&x.namedTypeDefinitions.has(f))&&((O=this.inclusionModeDefinition)==null||O.namedTypeDefinitions.set(f,{useAllData:!1,members:new Map})),r&&!((M=this.inclusionModeDefinition)!=null&&M.namedTypeDefinitions.get(f).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(f).members=new Map);const Se=this.sublayerCaches.get(f);vt.forEach(X=>{var ne,W;Se==null||Se.set(X.attributes[H],X),r&&!((ne=this.inclusionModeDefinition)!=null&&ne.namedTypeDefinitions.get(f).members.has(X.attributes[H]))&&((W=this.inclusionModeDefinition)==null||W.namedTypeDefinitions.get(f).members.set(X.attributes[H],{id:X.attributes[H]}),Y(this.memberIdTypeLookup,X.attributes[H],()=>new Set).add(f))})}const te=(Q=this.inclusionModeDefinition)==null?void 0:Q.namedTypeDefinitions.get(f);if(te)for(const D of A)(S=te.members)==null||S.delete(D)})().then(()=>{L(null)}).catch(I=>{I.name==="AbortError"?L(null):_(I)})});o.push(C),($=this._processingCacheUpdatesLookup.get(f))==null||$.push(C)}if(await Promise.all(o),(R=a==null?void 0:a.signal)==null?void 0:R.aborted)throw kt()}removeFromLayer(t){var r,a,s;const n=new Set,i=new Set(t.map(o=>o.id));for(const o of t)n.add(o.typeName),((r=this.memberIdTypeLookup.get(o.id))==null?void 0:r.size)===1?this.memberIdTypeLookup.delete(o.id):(a=this.memberIdTypeLookup.get(o.id))==null||a.delete(o.typeName),(s=this.inclusionModeDefinition)==null||s.namedTypeDefinitions.forEach((d,c)=>{var y;c===o.typeName&&((y=d.members)!=null&&y.has(o.id))&&d.members.delete(o.id)});n.forEach(o=>{var d;(d=this.sublayerCaches.get(o))==null||d.forEach((c,y)=>{var l;i.has(y)&&((l=this.sublayerCaches.get(o))==null||l.delete(y))})})}async retrieveDataFromService(t,n,i){var v,$,R,f,N,A,C,L,_,k,I,q,G,j,z,U,te,P;const r=Me.getInstance(),a=new Set,s=[];let o,d="",c=[];const y=n.graphType==="relationship",l=(R=($=(v=this.inclusionModeDefinition)==null?void 0:v.namedTypeDefinitions)==null?void 0:$.get(n.objectType.name))==null?void 0:R.useAllData,p=n.parentCompositeLayer.sublayerIdsCache.get(n.objectType.name);let u=!l&&p?Array.from(p).sort():null;if((A=(N=(f=this.inclusionModeDefinition)==null?void 0:f.namedTypeDefinitions)==null?void 0:N.get(n.objectType.name))!=null&&A.useAllData)(_=(L=(C=this.inclusionModeDefinition)==null?void 0:C.namedTypeDefinitions)==null?void 0:L.get(n.objectType.name))!=null&&_.useAllData&&t.objectIds!=null&&(u=t.objectIds);else if(t.objectIds!=null&&u&&u.length>0){const E=t.objectIds;t.objectIds=u.filter(w=>E.includes(w))}else if(t.objectIds!=null)u=t.objectIds;else{if((k=this.inclusionModeDefinition)!=null&&k.namedTypeDefinitions.has(n.objectType.name)&&(!((I=this.inclusionModeDefinition.namedTypeDefinitions.get(n.objectType.name))!=null&&I.members)||((G=(q=this.inclusionModeDefinition.namedTypeDefinitions.get(n.objectType.name))==null?void 0:q.members)==null?void 0:G.size)<1))return t.objectIds=[],[];t.objectIds=u}if(t.outFields!=null){const E=t.outFields;E.includes("*")?n.fields.forEach(w=>{a.add(w.name)}):E.forEach(w=>{w!==H&&w!==n.geometryFieldName&&a.add(w)})}if(t.geometry!=null){const E=t.geometry;let w;const F=n.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,x=F==null?void 0:F.spatialReference,O=(j=F==null?void 0:F.serviceCapabilities)==null?void 0:j.geometryCapabilities;let M=O==null?void 0:O.geometryMaxBoundingRectangleSizeX,Q=O==null?void 0:O.geometryMaxBoundingRectangleSizeY;if(E.type==="point"){let S=E;(z=S.spatialReference)!=null&&z.isWGS84||(await Ee(S.spatialReference,ie),S=he(S,ie)),w=new _e({spatialReference:ie,xmin:S.x-1e-4,ymin:S.y-1e-4,xmax:S.x+1e-4,ymax:S.y+1e-4})}else(U=E==null?void 0:E.extent)!=null&&U.spatialReference&&!((te=E.spatialReference)!=null&&te.isWGS84)?(await Ee(E.extent.spatialReference,ie),w=he(E.extent,ie)):w=E.extent;if(M&&Q&&x){if(x.wkid!==4326){const S=new _e({spatialReference:x,xmax:M,ymax:Q}),D=he(S,ie);M=D.xmax,Q=D.ymax}if(w.xmax-w.xmin>M)throw new Z("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${M}° latitude, limit exceeded`);if(w.ymax-w.ymin>Q)throw new Z("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${Q}° longitude, limit exceeded`)}if(t.where!=null&&t.where!=="1=1"){const S=await qe(t.where.toUpperCase(),n.fieldsIndex);n.fields.forEach(D=>{S.fieldNames.includes(D.name)&&a.add(D.name)})}d=y?`Match ()-[n:${n.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${n.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${n.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${n.geometryFieldName}) return ID(n)`,n.geometryFieldName&&a.add(n.geometryFieldName),a.forEach(S=>{d+=`, n.${S}`,s.push(S)}),o=new ae({openCypherQuery:d,bindParameters:{param_filter_geom:new bt({rings:ii(w)})}})}else{let E="";if(t.where!=null&&t.where!=="1=1"){const x=await qe(t.where,n.fieldsIndex);n.fields.forEach(M=>{x.fieldNames.includes(M.name)&&a.add(M.name)});const O={systemOidFieldName:H,supportedSqlTypes:new Set(["column-reference","string","number","binary-expression"]),supportedSqlOperators:new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]),unsupportedOperationFound:!1};E=Fe(x.parseTree,O),O.unsupportedOperationFound&&(E="")}let w="";w=y?`Match ()-[n:${n.objectType.name}]->()`:`Match (n:${n.objectType.name})`;let F=!1;u&&(F=!0,w+=" WHERE ID(n) IN $ids"),E&&(w+=F?" AND":" WHERE",w+=` ${E}`),w+=" return ID(n)",y&&(w+=", id(startNode(n)), id(endNode(n))"),t.returnGeometry&&n.geometryFieldName&&a.add(n.geometryFieldName),a.forEach(x=>{w+=`, n.${x}`,s.push(x)}),o=new ae(u?{openCypherQuery:w,bindParameters:{ids:u}}:{openCypherQuery:w})}const b=(await oe(n.parentCompositeLayer.dataManager.knowledgeGraph,o,i)).resultRowsStream.getReader();for(;;){const{done:E,value:w}=await b.read();if(E)break;const F=[];for(let x=0;x<w.length;x++){const O=w[x];let M=0,Q=0;const S={properties:{}};for(S.id=O[M],M++,Q++,y&&(S.originId=O[M],M++,Q++,S.destinationId=O[M],M++,Q++);M<O.length;M++)S.properties[s[M-Q]]=O[M];F.push(S)}c=c.concat(r.writeToStore(F,H,(P=n.parentCompositeLayer.dataManager.geographicLookup.get(n.objectType.name))==null?void 0:P.name))}return c}_isEndEntitySpatial(t,n,i){var r;for(const a of t??[])if(this.entityTypeNames.has(a)){const s=this.geographicLookup.get(a),o=s&&((r=this.sublayerCaches.get(a))==null?void 0:r.get(n.attributes[i]));if(s&&(o!=null&&o.attributes[s.name]))return!0}return!1}_getNamedTypeIdMapFromNodeIds(t){const n=new Map;return t.forEach(i=>{var r;if(this.memberIdTypeLookup.has(i))for(const a of this.memberIdTypeLookup.get(i)){if(!this.entityTypeNames.has(a))return;n.has(a)?(r=n.get(a))==null||r.push(i):n.set(a,[i])}}),n}};h([m()],K.prototype,"knowledgeGraph",void 0),h([m()],K.prototype,"inclusionModeDefinition",void 0),h([m()],K.prototype,"entityTypeNames",void 0),h([m()],K.prototype,"relationshipTypeNames",void 0),h([m()],K.prototype,"geographicLookup",void 0),h([m()],K.prototype,"sublayerCaches",void 0),h([m()],K.prototype,"nodeConnectionsLookup",void 0),h([m()],K.prototype,"relationshipConnectionsLookup",void 0),h([m()],K.prototype,"memberIdTypeLookup",void 0),K=h([ve("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],K);const ri=Symbol("isKnowledgeGraphGraphicOriginSymbol");var ot;class ai extends wt{get[(ot=ri,Dt)](){return this.sublayer}get[Ct](){return this.sublayer}get[Tt](){return this.sublayer}constructor(t,n){super(),this[ot]=!0,this.type="knowledge-graph",this.layer=t,this.sublayer=n}get id(){return this.layer.id}}const si=Symbol("isLinkChartGraphicOriginSymbol");var lt;let oi=class extends wt{get[(lt=si,Tt)](){return this.layer}constructor(t,n){super(),this[lt]=!0,this.type="link-chart",this.layer=t,this.sublayer=n}get id(){return`${this.layer.id}:__${this.sublayer.id}__`}};const pt=Ft(),li=e=>{const t=e;let n=class extends t{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return h([m(pt.fields)],n.prototype,"fields",void 0),h([m(pt.fieldsIndex)],n.prototype,"fieldsIndex",void 0),n=h([ve("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],n),n},pi=xt;let ee=class extends ft{constructor(e){super(e),this.entityAdds=void 0,this.entityUpdates=void 0,this.entityDeletes=void 0,this.relationshipAdds=void 0,this.relationshipUpdates=void 0,this.relationshipDeletes=void 0,this.options=void 0}};h([m()],ee.prototype,"entityAdds",void 0),h([m()],ee.prototype,"entityUpdates",void 0),h([m()],ee.prototype,"entityDeletes",void 0),h([m()],ee.prototype,"relationshipAdds",void 0),h([m()],ee.prototype,"relationshipUpdates",void 0),h([m()],ee.prototype,"relationshipDeletes",void 0),h([m()],ee.prototype,"options",void 0),ee=h([ve("esri.rest.knowledgeGraph.GraphApplyEdits")],ee);const di={initializeLayersFromClientData:async(e,t,n)=>{if(t||(t=[...e.layers,...e.tables].map(a=>a.graphTypeName)),(t==null?void 0:t.length)===0)return;const i=new Map;for(const a of t)i.set(a,dt(e,a));const r=await $n(e.dataManager.knowledgeGraph,Array.from(i.values()),{requestOptions:{signal:n==null?void 0:n.signal}});for(const a of[...e.layers,...e.tables]){const s=a.objectType.name;if(s==null)continue;const o=r.get(dt(e,s));if(o){const d=JSON.parse(o);d===null||typeof d!="object"||d.hasOwnProperty("showLabels")||(d.showLabels=!1),a.read(d,{origin:"service"})}}},getInclusionDefinitionFromCypherResults:async(e,t,n)=>{const i=ct(e.dataModel),r=(await oe(e,t,n)).resultRowsStream.getReader();for(;;){const{done:a,value:s}=await r.read();if(a)break;for(const o of s)for(const d of o)Te(d,i)}return i},getInclusionDefinitionFromIdTypePairs:(e,t)=>{var i;const n=ct(e.dataModel);for(const{id:r,typeName:a}of t){const s=n.namedTypeDefinitions.get(a);if(!s)throw new Z("WebLinkChart:data-model-desync","The provided id-type pairs contained a named type not reflected in the provided knowledge graph data model.");(i=s.members)==null||i.set(r,{id:r})}return n}},dt=(e,t)=>e.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function sr(e,t,n){return di.initializeLayersFromClientData(e,t,n)}const ut=["#4a0932","#b31515","#18382e","#a64f1b","#102432","#8c213f","#ed9310","#2c6954","#144d59","#ffc730","#75351e","#454f4b","#78b1c2","#191921","#8f8f82","#9be0c0","#dbb658","#87b051","#11495c","#c43541","#9c5596","#44498b","#ad9d63","#86afb3","#5c98ca","#b0bfa2","#73241f","#b86b53","#d9d78c","#3e756d","#f260a1","#a0d17d","#c27c30","#eb82eb","#ffdf3c","#ffb259","#ab52b3","#3cccb4","#0095ba","#d92b30"],ui="#8f8f82";function ci(e){return e<0||e>=ut.length?new Pe(ui):new Pe(ut[e])}function yi(e){const t=e.toArray();return new Rt({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,style:"solid",width:.75,color:t},{type:"CIMVectorMarker",enable:!0,size:6,markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-10,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[1.96,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:t}]}}]}]}}})}function hi(e){let t="ESRI__ID",n=4;for(const i of e)if(i.name){if(i.name.toLowerCase()==="name"){t=i.name;break}i.name.toLowerCase().includes("name")?(t=i.name,n=2):i.fieldType==="esriFieldTypeString"&&n>3&&(t=i.name,n=3)}return t}function mi(e,t,n){const i={color:[80,80,80],haloColor:[255,255,255],haloSize:.7,font:{size:10,weight:"normal"}},r=new pe({labelExpressionInfo:new me({expression:n==="ESRI__ID"?`${t}`:`$feature.${n}`}),labelPlacement:"above-center",symbol:new fe(i)}),a=new pe({labelExpressionInfo:new me({expression:`'${t}' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')`}),labelPlacement:"center-along",labelPosition:"parallel",repeatLabel:!1,symbol:new fe({...i,yoffset:"12px"})});return e==="entity"?[r]:[a]}function fi(e,t,n){const i={color:[255,255,255],haloColor:[0,0,0],haloSize:.7,font:{size:10,weight:"bold"}},r=n==="ESRI__ID"?`${e}`:`$feature.${n}`;return t==="point"?[new pe({labelExpressionInfo:new me({expression:r}),labelPlacement:"above-center",symbol:new fe(i)})]:t==="polyline"?[new pe({labelExpressionInfo:new me({expression:r}),labelPlacement:"center-along",repeatLabel:!0,symbol:new fe(i)})]:t==="polygon"?[new pe({labelExpressionInfo:new me({expression:r}),labelPlacement:"always-horizontal",symbol:new fe(i)})]:null}const gi={capabilities:[],allowGeometryUpdates:!1,serviceCapabilities:{geometryCapabilities:{supportsZValues:!1,supportsMValues:!1}}};function bi(e){const{capabilities:t,allowGeometryUpdates:n,serviceCapabilities:{geometryCapabilities:{supportsZValues:i,supportsMValues:r}}}=(e==null?void 0:e.serviceDefinition)||gi,a=e!=null&&e.dataModel.arcgisManaged?t:t.filter(o=>o==="Query"),s=new Set(a);return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:r,supportsZ:i},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:s.has("Create"),supportsDelete:s.has("Delete"),supportsEditing:s.has("Editing"),supportsChangeTracking:!1,supportsQuery:s.has("Query"),supportsQueryBins:!1,supportsQueryPivot:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:s.has("Update"),supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},query:kn,queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:Dn,editing:{supportsGeometryUpdate:!!(e!=null&&e.dataModel.arcgisManaged)&&n,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:s.has("Delete"),supportsUpdateByAnonymous:!1,supportsUpdateByOthers:s.has("Update"),supportsAsyncApplyEdits:!1,zDefault:void 0}}}async function wi(e,t){var y;const n=new ee,i=t.graphTypeName,r=t.graphType,a=t.parentCompositeLayer.type==="knowledge-graph"?t.geometryFieldName:null,s=!!((y=t.fieldsIndex.get(a))!=null&&y.editable),o=l=>{const p={...l};for(const u of t.fields)u.editable||delete p[u.name];for(const u of Object.keys(l))u.includes("ESRI__")&&delete p[u];return p},d=async l=>{await Ee(l.spatialReference,Ie.WGS84);const p=he(l,Ie.WGS84);return p.type==="point"?p.normalize():(await jt(p))[0]};for(const l of e.addFeatures??[]){const p=o(l.attributes);Ge(l.sourceLayer)&&l.sourceLayer.graphTypeName===i&&(r==="entity"?(n.entityAdds||(n.entityAdds=[]),a&&l.geometry&&(p[a]=await d(l.geometry)),n.entityAdds.push(new He({properties:p,typeName:i}))):(n.relationshipAdds||(n.relationshipAdds=[]),n.relationshipAdds.push(new ze({properties:p,typeName:i}))))}for(const l of e.updateFeatures??[]){const p=l.attributes[H],u=o(l.attributes);Ge(l.sourceLayer)&&l.sourceLayer.graphTypeName===i&&(r==="entity"?(n.entityUpdates||(n.entityUpdates=[]),a&&s&&l.geometry&&(u[a]=await d(l.geometry)),n.entityUpdates.push(new He({id:p,properties:u,typeName:i}))):(n.relationshipUpdates||(n.relationshipUpdates=[]),n.relationshipUpdates.push(new ze({id:p,properties:u,typeName:i}))))}const c=new Map;for(const l of e.deleteFeatures??[])if(At(l)){const p=l,u=Y(c,p.sourceLayer.graphTypeName,()=>({typeName:p.sourceLayer.graphTypeName,ids:[]}));p.sourceLayer.graphTypeName===i&&u.ids.push(p.attributes[H])}else l.objectId&&typeof l.objectId=="string"&&Y(c,i,()=>({typeName:i,ids:[]})).ids.push(l.objectId);for(const l of c.values())l.ids.length>0&&(r==="entity"?(n.entityDeletes||(n.entityDeletes=[]),n.entityDeletes.push({typeName:l.typeName,ids:l.ids})):(n.relationshipDeletes||(n.relationshipDeletes=[]),n.relationshipDeletes.push({typeName:l.typeName,ids:l.ids})));return n}function Ti(e,t){const n={addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]};for(const i of e.editResults)if(i.typeName===t){for(const r of i.adds)n.addFeatureResults.push({objectId:r.id,globalId:r.id});for(const r of i.updates)n.updateFeatureResults.push({objectId:r.id,globalId:r.id});for(const r of i.deletes)n.deleteFeatureResults.push({objectId:r.id,globalId:r.id})}return n}function Ii(e){if(!e.objectType)return null;const t=[];for(const n of e.fields)!n.name.includes("ESRI__")&&n.editable&&n.type!=="geometry"&&t.push(new pi({fieldName:n.name}));return new It({elements:t})}function Ei(e){if(!e.objectType)return null;let t=null;switch(e.geometryType){case"point":case"multipoint":t="point";break;case"polyline":t="line";break;case"polygon":t="polygon";break;default:t=null}return[new Et({name:e.graphTypeName,drawingTool:t,prototype:{}})]}function _i(e){return!(!e||typeof e!="object"||Array.isArray(e))&&"id"in e&&"typeName"in e}function $i(e){return!(!e||typeof e!="object"||Array.isArray(e))&&e&&"path"in e&&Array.isArray(e.path)}function Ni(e){return!(!e||typeof e!="object"||Array.isArray(e)||"id"in e)&&"properties"in e&&typeof e.properties=="object"}function ct(e){const t={namedTypeDefinitions:new Map,generateAllSublayers:!1},{entityTypes:n,relationshipTypes:i}=e,r=[...n,...i];for(const a of r)t.namedTypeDefinitions.set(a.name,{useAllData:!1,members:new Map});return t}function Te(e,t){if(e&&typeof e=="object"){if(_i(e)){const n=t.namedTypeDefinitions.get(e.typeName);if(!n)throw new Z("WebLinkChart:data-model-desync","The query result contained a named type not reflected in the provided knowledge graph data model.");n.members.set(e.id,{id:e.id})}else if($i(e))for(const n of e.path)Te(n,t);else if(Array.isArray(e))for(const n of e)Te(n,t);else if(Ni(e))for(const n of Object.values(e.properties??{}))Te(n,t)}}function J(e){if(!e.json)return e;e.json.write=yt(e.json.write);const t=e.json.origins;if(!t)return e;let n;for(n in t){const i=t[n];i&&(i.write=yt(i.write))}return e}function yt(e){return typeof e=="object"&&e?(e.enabled!==!1&&(e.overridePolicy=vi(e)),e):e===!0?ce():e}function vi(e){const{target:t,writer:n,overridePolicy:i,...r}=e;return function(a,s){const o=Nt.call(this,a,s);return o.enabled?{...r,...o}:o}}function ce(){return{overridePolicy:Nt}}function Nt(e,t){const n=!!this.geometryType;let i={enabled:n};return n&&(i={...i,...ye.call(this,e,t)}),i}function ye(e,t){return{ignoreOrigin:this.originIdOf(t)>0}}let g=class extends li(Ot(qt(Pt(Gt(Ut(Ht(zt(Qt(Wt(In)))))))))){constructor(e){super(e),this.blendMode="normal",this.charts=null,this.definitionExpression=null,this.displayFilterEnabled=!0,this.displayFilterInfo=null,this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=H,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{const t=new MessageChannel;return new Bt(t.port1,{channel:t,client:{queryFeatures:(n,i={})=>{const r=le.fromJSON(n);return this.queryFeaturesJSON(r,i)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get capabilities(){return this.parent?this.parent.sublayerCapabilities:bi(null)}get userHasUpdateItemPrivileges(){var e;return!!((e=this.parent)!=null&&e.userHasUpdateItemPrivileges)}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.capabilities.operations.supportsEditing}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}get isTable(){var e;return((e=this.parentCompositeLayer)==null?void 0:e.type)!=="link-chart"&&this.geometryFieldName==null}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var n,i,r;const e=[],t=new Map;for(const a of((n=this.parent)==null?void 0:n.knowledgeGraph.dataModel.domains)??[])t.set(a.name,a);return(r=(i=this.objectType)==null?void 0:i.properties)==null||r.forEach(a=>{const s=a.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":a.fieldType,o=we.fromJSON({name:a.name,type:s,alias:a.alias,defaultValue:a.defaultValue,editable:a.editable,nullable:a.nullable,domain:a.domain&&t.has(a.domain)?t.get(a.domain).toJSON():void 0});e.push(o)}),e.push(we.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),we.fromJSON({name:De,type:"esriFieldTypeInteger",alias:De,editable:!1}),we.fromJSON({name:ge,type:"esriFieldTypeInteger",alias:ge,editable:!1})),e}get formTemplate(){return this._isOverridden("formTemplate")?this._get("formTemplate"):Ii(this)}set formTemplate(e){this._overrideIfSome("formTemplate",e)}get geometryType(){var n,i,r;if(((n=this.parentCompositeLayer)==null?void 0:n.type)==="link-chart")return this.graphType==="relationship"?"polyline":"point";const e=(r=this.parentCompositeLayer)==null?void 0:r.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name),t=e==null?void 0:e.geometryType;return t&&t!=="esriGeometryNull"?ue.fromJSON(t):null}get geometryFieldName(){var t,n,i;if(((t=this.parentCompositeLayer)==null?void 0:t.type)==="link-chart")return Ae;const e=(i=this.parentCompositeLayer)==null?void 0:i.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name);return(e==null?void 0:e.name)??null}get graphicOrigin(){if(!this.parent)return null;switch(this.parent.type){case"knowledge-graph":return new ai(this.parent,this);case"link-chart":return new oi(this.parent,this)}}get graphTypeName(){var e;return(e=this.objectType)==null?void 0:e.name}set graphTypeName(e){this._set("graphTypeName",e)}get hasM(){var i,r,a,s;const e=(r=this.parentCompositeLayer)==null?void 0:r.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name),t=e==null?void 0:e.name,n=t?(s=(a=this.objectType)==null?void 0:a.properties)==null?void 0:s[t]:null;return(n==null?void 0:n.hasM)??!1}get hasZ(){var i,r,a,s;const e=(r=this.parentCompositeLayer)==null?void 0:r.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name),t=e==null?void 0:e.name,n=t?(s=(a=this.objectType)==null?void 0:a.properties)==null?void 0:s[t]:null;return(n==null?void 0:n.hasZ)??!1}set labelingInfo(e){this._set("labelingInfo",e)}get labelingInfo(){if(this._isOverridden("labelingInfo"))return this._get("labelingInfo");if(!this.objectType||!this.parentCompositeLayer||!this.graphTypeName)return null;const e=this.objectType.properties?hi(this.objectType.properties):"ESRI__ID";return this.parentCompositeLayer.type==="link-chart"?mi(this.graphType,this.graphTypeName,e):fi(this.graphTypeName,this.geometryType,e)}set renderer(e){Vt(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var r,a,s,o;if(this._isOverridden("renderer"))return this._get("renderer");const e=(s=(a=(r=this.parentCompositeLayer)==null?void 0:r.dataManager)==null?void 0:a.knowledgeGraph)==null?void 0:s.dataModel,t=[...(e==null?void 0:e.entityTypes)??[],...(e==null?void 0:e.relationshipTypes)??[]].map(d=>d.name).indexOf(this.graphTypeName),n=ci(t);if(((o=this.parentCompositeLayer)==null?void 0:o.type)==="link-chart"){if(this.graphType==="relationship")return new Jt({type:"simple",symbol:yi(n)});const d=Ue(Qe(ue.toJSON("point")).renderer);return We(d.symbol,n),d}const i=Ue(Qe(ue.toJSON(this.geometryType)).renderer);return We(i.symbol,n),i}get spatialReference(){var e,t,n,i;return((i=(n=(t=(e=this.parentCompositeLayer)==null?void 0:e.dataManager)==null?void 0:t.knowledgeGraph)==null?void 0:n.dataModel)==null?void 0:i.spatialReference)??Ie.WGS84}get templates(){return this._isOverridden("templates")?this._get("templates"):Ei(this)}set templates(e){this._overrideIfSome("templates",e)}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return Zt(this,e)}createQuery(){return new le({where:"1=1",outFields:["*"]})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){var n;return((n=this.fields.find(i=>i.name===e))==null?void 0:n.domain)||null}async queryFeatures(e,t){await this.load();const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e),r=this.graphicOrigin,a=Kt.fromJSON(await i.executeQuery(n.toJSON(),t==null?void 0:t.signal));return a.features.forEach(s=>{s.sourceLayer=this,s.origin=r}),a}async queryFeaturesJSON(e,t){await this.load();const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e);return await i.executeQuery(n.toJSON(),t==null?void 0:t.signal)}async queryFeatureCount(e,t){await this.load();const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e);return i.executeQueryForCount(n.toJSON(),t==null?void 0:t.signal)}async queryExtent(e={},t){var o,d,c,y;await this.load();const n={...e,returnGeometry:!0},{resolvedQuery:i,queryEngine:r}=await this._setupQueryObjects(n),a=await r.executeQueryForExtent(i.toJSON(),t==null?void 0:t.signal);let s;return s=((o=a.extent)==null?void 0:o.xmin)!=null&&((d=a.extent)==null?void 0:d.xmax)!=null&&((c=a.extent)==null?void 0:c.ymin)!=null&&((y=a.extent)==null?void 0:y.ymax)!=null?new _e(a.extent):new _e,{count:a.count,extent:s}}async queryObjectIds(e,t){await this.load();const n=le.from(e);let i;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const r=await this.parentCompositeLayer.dataManager.getData(n,this,t);i=this.loadQueryEngine(r)}return await i.executeQueryForIds(n.toJSON(),t==null?void 0:t.signal)}async applyEdits(e){var a;if(!this.parentCompositeLayer.dataManager.knowledgeGraph)throw new Z("knowledge-graph-sublayer:no-knowledge-graph","ApplyEdits cannot be executed because the parent does not have a Knowledge Graph model.  This is usually caused by the layer not yet being loaded");const t=await wi(e,this);t.options={cascadeDelete:!0,cascadeProvenanceDelete:!!((a=this.parent)!=null&&a.knowledgeGraph.serviceDefinition.supportsProvenance)||void 0};const n=await Nn(this.parentCompositeLayer.dataManager.knowledgeGraph,t),i=Ti(n,this.graphTypeName),r={addedFeatures:i.addFeatureResults,updatedFeatures:i.updateFeatureResults,deletedFeatures:i.deleteFeatureResults,addedAttachments:i.addAttachmentResults,deletedAttachments:i.deleteAttachmentResults,updatedAttachments:i.updateAttachmentResults,exceededTransferLimit:!1,historicMoment:new Date,edits:void 0};return this.emit("edits",r),this.emit("apply-edits",{result:Promise.resolve(r)}),this.parentCompositeLayer.type==="link-chart"&&await this.parentCompositeLayer.refreshLinkChartCache([...r.addedFeatures.map(s=>s.globalId),...r.updatedFeatures.map(s=>s.globalId),...r.deletedFeatures.map(s=>s.globalId)]),i}loadQueryEngine(e){var i;const t=new Ln({geometryType:ue.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new Mn({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:ue.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,featureIdInfo:{type:"object-id",fieldName:this.objectIdField},spatialReference:this.spatialReference.toJSON(),timeInfo:(i=this.timeInfo)==null?void 0:i.toJSON(),featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new le({where:"1=1",outFields:[H]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then(()=>Yt(this.timeInfo,this.fieldsIndex))),Promise.resolve(this)}async _setupQueryObjects(e,t){var a;const n=le.from(e),i=n.geometry;if(i&&!((a=i.spatialReference)!=null&&a.isWGS84)&&(await Ee(i.spatialReference,ie),n.geometry=he(i instanceof bt||i instanceof Xt||i instanceof en?i:i.extent,ie)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)return{resolvedQuery:n,queryEngine:this._cachedQueryEngine};const r=await this.parentCompositeLayer.dataManager.getData(n,this,t);return{resolvedQuery:n,queryEngine:this.loadQueryEngine(r)}}};function Si(e,t,n){var r,a;const i=[["ESRI__AGGREGATION_COUNT",De],["ESRI__ORIGIN_ID",$e],["ESRI__DESTINATION_ID",Ne],["ESRI__LAYOUT_GEOMETRY",Ae]];try{for(const s of e)for(const[o,d]of i)s.labelExpression=(r=s.labelExpression)==null?void 0:r.replaceAll(o,d),(a=s.labelExpressionInfo)!=null&&a.expression&&(s.labelExpressionInfo.expression=s.labelExpressionInfo.expression.replaceAll(o,d))}catch(s){gt.getLogger(this).warn("Error updating labelingInfo",s)}return Tn(e,t,n)}h([m(J(V(tn)))],g.prototype,"blendMode",void 0),h([m({readOnly:!0})],g.prototype,"capabilities",null),h([m({readOnly:!0})],g.prototype,"userHasUpdateItemPrivileges",null),h([m({type:Boolean})],g.prototype,"editingEnabled",null),h([m()],g.prototype,"isTable",null),h([m({json:{origins:{"web-scene":{write:!1}},write:ce()}})],g.prototype,"charts",void 0),h([m({readOnly:!0})],g.prototype,"defaultPopupTemplate",null),h([m({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],g.prototype,"definitionExpression",void 0),h([m(J(V(nn)))],g.prototype,"displayFilterEnabled",void 0),h([m(J(V(rn)))],g.prototype,"displayFilterInfo",void 0),h([m(J(V(an)))],g.prototype,"effect",void 0),h([m({type:sn})],g.prototype,"elevationInfo",void 0),h([m(J(V(on)))],g.prototype,"featureEffect",void 0),h([m(J(V(ln)))],g.prototype,"featureReduction",null),h([m()],g.prototype,"fields",null),h([m({type:It})],g.prototype,"formTemplate",null),h([m()],g.prototype,"geometryType",null),h([m()],g.prototype,"geometryFieldName",null),h([m({readOnly:!0})],g.prototype,"graphicOrigin",null),h([m({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],g.prototype,"graphType",void 0),h([m({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],g.prototype,"graphTypeName",null),h([m()],g.prototype,"hasM",null),h([m()],g.prototype,"hasZ",null),h([m({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],g.prototype,"id",void 0),h([m({type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",default:!1,write:{overridePolicy(){return{enabled:!!this.geometryType,alwaysWriteDefaults:!0,ignoreOrigin:!0}}}}})],g.prototype,"labelsVisible",void 0),h([m({type:[pe],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:Si,write:ce()}})],g.prototype,"labelingInfo",null),h([m({readOnly:!0,json:{read:!1,write:{writer(e,t){var n;switch((n=this.parentCompositeLayer)==null?void 0:n.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],g.prototype,"layerType",void 0),h([m(J(V(pn)))],g.prototype,"legendEnabled",void 0),h([m(J(V(dn)))],g.prototype,"maxScale",void 0),h([m(J(V(un)))],g.prototype,"minScale",void 0),h([m()],g.prototype,"objectIdField",void 0),h([m()],g.prototype,"objectType",void 0),h([m(J(V(cn)))],g.prototype,"opacity",void 0),h([m(J(V(yn)))],g.prototype,"orderBy",void 0),h([m({clonable:!1})],g.prototype,"parent",void 0),h([m()],g.prototype,"parentCompositeLayer",void 0),h([m(J(V(hn)))],g.prototype,"popupEnabled",void 0),h([m({type:mn,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],g.prototype,"popupTemplate",void 0),h([m({type:Number,json:{write:{overridePolicy:ye}}})],g.prototype,"refreshInterval",void 0),h([m({types:fn,json:{name:"layerDefinition.drawingInfo.renderer",write:ce()}})],g.prototype,"renderer",null),h([m()],g.prototype,"source",void 0),h([m()],g.prototype,"spatialReference",null),h([m({type:Et})],g.prototype,"templates",null),h([m({type:gn,json:{name:"layerDefinition.timeInfo",write:{overridePolicy:ye},origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:{overridePolicy:ye}},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:{overridePolicy:ye}}}}})],g.prototype,"timeInfo",null),h([m({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],g.prototype,"title",null),h([bn("title")],g.prototype,"writeTitle",null),h([m({json:{read:!1}})],g.prototype,"type",void 0),h([m(J(V(wn)))],g.prototype,"useViewTime",void 0),h([m({type:Boolean,json:{name:"visibility",write:ce()}})],g.prototype,"visible",void 0),g=h([ve("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],g);export{nt as A,ir as C,er as I,sr as L,K as N,bi as P,g as R,nr as a,st as b,rt as c,at as d,it as e,Yi as f,Xi as g,tt as h,et as p,tr as r,Me as s};
