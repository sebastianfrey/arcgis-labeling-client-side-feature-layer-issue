import{bB as a,fO as p,gs as G,bE as m,bC as I,b3 as f,gn as l,gp as x,go as w,gN as Q,fN as q,aN as O,eF as R}from"./index-C_bK48d2.js";import{c as s,r as S}from"./vectorStacks-CpRnv_41.js";function un(t,n,r){const u=a(t,n)/a(t,t);return l(r,t,u)}function _(t,n){return a(t,n)/p(t)}function cn(t,n){const r=a(t,n)/(p(t)*p(n));return-G(r)}function on(t,n,r){m(j,t),m(k,n);const u=a(j,k),c=G(u),i=I(j,j,k);return a(i,r)<0?2*Math.PI-c:c}const j=f(),k=f();function en(t){const n=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],r=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],u=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(n,r,u))}function an(t,n){const r=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),u=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),c=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return x(t,r,u,c),t}function T(t,n,r){Math.abs(t[0])>Math.abs(t[1])?x(n,0,1,0):x(n,1,0,0),I(r,t,n),I(n,r,t),m(r,r),m(n,n)}function fn(t,n,r,u=f()){const c=p(t),i=p(n),e=a(t,n)/(c*i);if(e<.9999999999999999){const o=Math.acos(e),g=((1-r)*c+r*i)/Math.sin(o),$=g/c*Math.sin((1-r)*o),h=g/i*Math.sin(r*o);return l(z,t,$),l(D,n,h),w(u,z,D)}return Q(u,t,n,r)}const z=f(),D=f();function J(t=d){return[t[0],t[1],t[2],t[3]]}function sn(t=d[0],n=d[1],r=d[2],u=d[3]){return K(t,n,r,u,S.get())}function U(t,n){return K(n[0],n[1],n[2],n[3],t)}function gn(t){return t}function K(t,n,r,u,c=J()){return c[0]=t,c[1]=n,c[2]=r,c[3]=u,c}function V(t,n,r){const u=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],c=Math.abs(u-1)>1e-5&&u>1e-12?1/Math.sqrt(u):1;return r[0]=n[0]*c,r[1]=n[1]*c,r[2]=n[2]*c,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function W(t,n,r,u=J()){const c=r[0]-n[0],i=r[1]-n[1],e=r[2]-n[2],o=t[0]-n[0],g=t[1]-n[1],$=t[2]-n[2],h=i*$-e*g,C=e*o-c*$,E=c*g-i*o,F=h*h+C*C+E*E,H=Math.abs(F-1)>1e-5&&F>1e-12?1/Math.sqrt(F):1;return u[0]=h*H,u[1]=C*H,u[2]=E*H,u[3]=-(u[0]*t[0]+u[1]*t[1]+u[2]*t[2]),u}function L(t,n,r,u=0,c=Math.floor(r*(1/3)),i=Math.floor(r*(2/3))){if(r<3)return!1;n(y,u);let e=c,o=!1;for(;e<r-1&&!o;)n(b,e),e++,o=!O(y,b);if(!o)return!1;for(e=Math.max(e,i),o=!1;e<r&&!o;)n(M,e),e++,q(A,y,b),m(A,A),q(B,b,M),m(B,B),o=!O(y,M)&&!O(b,M)&&Math.abs(a(A,B))<X;return o?(W(y,b,M,t),!0):(u!==0||c!==1||i!==2)&&L(t,n,r,0,1,2)}function hn(t,n,r=!0){const u=n.length/3;return L(t,(c,i)=>x(c,n[3*i+0],n[3*i+1],n[3*i+2]),r?u-1:u)}const X=.99619469809,y=f(),b=f(),M=f(),A=f(),B=f();function Mn(t,n,r){return n!==t&&U(t,n),t[3]=-a(t,r),t}function $n(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function bn(t,n,r,u){return I(M,n,t),V(r,M,u)}function mn(t,n,r,u){return P(v(t,n,q(s.get(),r,n),Z,u))}function ln(t,n,r){return n!=null&&P(v(t,n.origin,n.direction,nn,r))}function qn(t,n,r){return P(v(t,n.origin,n.vector,0,r))}function yn(t,n,r){return P(v(t,n.origin,n.vector,1,r))}function dn(t,n){return N(t,n)>=0}function pn(t,n){const r=a(t,n.ray.direction),u=-N(t,n.ray.origin);if(u<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return u>0;if((u<0||r<0)&&!(u<0&&r<0))return!0;const c=u/r;return r>0?c<n.c1&&(n.c1=c):c>n.c0&&(n.c0=c),n.c0<=n.c1}function xn(t,n){const r=a(t,n.ray.direction),u=-N(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return u>0;const c=u/r;return r>0?c<n.c1&&(n.c1=c):c>n.c0&&(n.c0=c),n.c0<=n.c1}function Nn(t,n,r){const u=l(s.get(),t,-t[3]),c=Y(t,q(s.get(),n,u),s.get());return w(r,c,u),r}function jn(t,n,r,u){const c=t,i=s.get(),e=s.get();T(c,i,e);const o=q(s.get(),r,n),g=_(i,o),$=_(e,o),h=_(c,o);return x(u,g,$,h)}function Y(t,n,r){const u=l(s.get(),t,a(t,n));return q(r,n,u),r}function An(t,n){return Math.abs(N(t,n))}function N(t,n){return a(t,n)+t[3]}function P(t){return t===0||t===1}function v(t,n,r,u,c){const i=a(t,r),e=N(t,n);if(i===0)return e>=0?2:3;let o=-e/i;return 1&u&&(o=R(o,0,1)),!(4&u)&&o<0||!(8&u)&&o>1?e>=0?2:3:(w(c,n,l(c,r,o)),e>=0?0:1)}const d=[0,0,1,0],Z=12,nn=8;export{Mn as G,$n as H,bn as I,mn as J,ln as K,qn as L,yn as N,dn as O,pn as P,xn as Q,Nn as R,L as S,jn as T,V as U,An as W,N as X,v as Z,cn as a,T as b,sn as d,un as e,_ as f,an as g,J as j,gn as k,en as m,fn as q,on as u,W as w,K as x,U as y,hn as z};
