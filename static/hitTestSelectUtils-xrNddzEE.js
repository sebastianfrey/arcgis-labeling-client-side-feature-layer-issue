import{aJ as u,aK as d,aL as nt,db as st,b5 as Mt,mF as $,mG as ve,d3 as Lt,bb as $e,gO as Ut,aI as un,fv as cn,rR as pn,nv as hn,ap as dn,fz as fn,rS as ue,rT as yn,hX as gn,hZ as k,mY as vn,rU as be,pc as V,i0 as H,pa as lt,pb as et,mX as $n,rV as bn,bp as ht,gp as G,h7 as T,bB as _,l0 as N,rE as mn,b6 as K,l$ as wt,b3 as f,bH as me,gq as ct,fN as Gt,bC as kt,kX as Wt,mZ as xn,kF as xe,m1 as wn,N as Nn,aN as x,h as Mn,gw as Ln,br as kn,bu as _n,bE as Tn,ie as Sn,i$ as zn,no as jn,jZ as we,bL as En,rW as ce,dg as qn,bo as Ne,jg as Pn,bn as On,j6 as Rn,rX as Bn,aa as Me,iZ as Hn,rY as Le}from"./index-C_bK48d2.js";import{t as jt,i as ke,p as Dt}from"./projectVectorToVector-IRvjF_FZ.js";import{j as Xt,q as _e,b as Te,y as Se}from"./geodesicUtils-CTZo9mb6.js";import{j as q,O as Dn,U as Et,W as Jt,b as ze,J as je,X as In,R as Ee,k as qe,w as Zn}from"./plane-CYaN818s.js";import{E as Vn}from"./sphere-Dx28BAGo.js";import{E as An,k as Kt,b as Un,I as Wn}from"./elevationInfoUtils-C7MilKvD.js";import{a as qt}from"./quantity-wpyqwS5w.js";import{c as Xn,a as Jn}from"./spatialReferenceEllipsoidUtils-DtI6yob-.js";let Nt=class extends st{constructor(t){super(t),this.enabled=!1}};u([d({type:Boolean,nonNullable:!0})],Nt.prototype,"enabled",void 0),Nt=u([nt("esri.views.interactive.sketch.SketchLabelOptions")],Nt);const Pe=Nt;let pt=class extends st{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};u([d({type:String,nonNullable:!0})],pt.prototype,"mode",void 0),pt=u([nt("esri.views.interactive.sketch.SketchTooltipElevationOptions")],pt);let w=class extends st{constructor(t){super(t),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};u([d({type:Boolean,nonNullable:!0})],w.prototype,"area",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"coordinates",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"direction",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"distance",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"elevation",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"header",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"helpMessage",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"orientation",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"radius",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"rotation",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"scale",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"size",void 0),u([d({type:Boolean,nonNullable:!0})],w.prototype,"totalLength",void 0),w=u([nt("esri.views.interactive.sketch.SketchTooltipVisibleElements")],w);const Oe=w;let L=class extends st{constructor(t){super(t),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new pt,this.placement="auto",this.offset=null,this.visibleElements=new Oe,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};u([d({type:Boolean,nonNullable:!0})],L.prototype,"enabled",void 0),u([d()],L.prototype,"forceEnabled",void 0),u([d()],L.prototype,"effectiveEnabled",null),u([d()],L.prototype,"helpMessage",void 0),u([d()],L.prototype,"helpMessageIcon",void 0),u([d({type:Boolean,nonNullable:!0})],L.prototype,"inputEnabled",void 0),u([d({type:pt,nonNullable:!0})],L.prototype,"elevation",void 0),u([d()],L.prototype,"placement",void 0),u([d()],L.prototype,"offset",void 0),u([d({type:Oe,nonNullable:!0})],L.prototype,"visibleElements",void 0),u([d()],L.prototype,"visualVariables",void 0),u([d()],L.prototype,"xyMode",void 0),L=u([nt("esri.views.interactive.sketch.SketchTooltipOptions")],L);const Re=L;let rt=class extends st{constructor(t){super(t),this.length=null,this.verticalLength=null,this.area=null}};u([d()],rt.prototype,"length",void 0),u([d()],rt.prototype,"verticalLength",void 0),u([d()],rt.prototype,"area",void 0),rt=u([nt("esri.views.interactive.sketch.Units")],rt);const _t=rt;let J=class extends st{constructor(t){super(t),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?"relative-bilateral":"relative";case"absolute":return"absolute"}}get displayUnits(){return this._get("displayUnits")??new _t}set displayUnits(t){this._set("displayUnits",t)}get inputUnits(){return this._get("inputUnits")??new _t}set inputUnits(t){this._set("inputUnits",t)}};u([d({type:String,nonNullable:!0})],J.prototype,"directionMode",void 0),u([d({type:Boolean,nonNullable:!0})],J.prototype,"relativeDirectionIsBilateral",void 0),u([d()],J.prototype,"effectiveDirectionMode",null),u([d({type:_t,nonNullable:!0})],J.prototype,"displayUnits",null),u([d({type:_t,nonNullable:!0})],J.prototype,"inputUnits",null),J=u([nt("esri.views.interactive.sketch.SketchValueOptions")],J);const Be=J;let it=class extends st{constructor(t){super(t),this.labels=new Pe,this.tooltips=new Re,this.values=new Be}};u([d({nonNullable:!0,type:Pe})],it.prototype,"labels",void 0),u([d({nonNullable:!0,type:Re})],it.prototype,"tooltips",void 0),u([d({nonNullable:!0,type:Be})],it.prototype,"values",void 0),it=u([nt("esri.views.interactive.sketch.SketchOptions")],it);const sr=it;function He(e,t,n){return S(e,t,n)}function S(e=0,t=0,n=0){return Mt(e,t,n)}function rr(e){return e}function ir(e){return e}function Y(e,t,n){return Mt(e,t,n)}function ot(e){const[t,n,s]=e;return e.length>3?[t,n,s,e[3]]:[t,n,s]}function or(e){return e[3]=1|((e.length>3?e[3]:void 0)??0),e}function ar(e){return!!(1&((e.length>3?e[3]:void 0)??0))}function pe(e,t,{coordinateHelper:n,elevationInfo:s},r){return e?Cn(n.vectorToDehydratedPoint(e,Fn),t,s,r):null}function Cn(e,t,n,s=S()){return s[0]=e.x,s[1]=e.y,s[2]=e.z??0,t==null||(t.type==="2d"?s[2]=0:s[2]=An(t,e,n,Kt)??0),s}function lr(e,t,n){return n?(ke(n,e[0],e[1],e[2],t),n):jt(e[0],e[1],e[2],t)}function ur(e,t,{z:n,m:s},r,i){const{spatialReference:o,elevationInfo:a}=r;let l;n==null&&s==null?l=void 0:t==null||t.type==="2d"?l=n??void 0:l=Un(t,e,o,Kt,a)??0;const[c,p]=e;return i?ke(i,c,p,l,o):i=jt(c,p,l,o),s!=null&&(i.m=s,i.hasM=!0),i}function cr(e,t,n,s,r=S()){const[i,o]=e;return r[0]=i,r[1]=o,e.length>3&&(r[3]=e[3]??0),(n==null?void 0:n.type)!=="3d"?(r[2]=t.value,r):(r[2]=Wn(n,i,o,t.value,s,t.elevationInfo,Kt)??0,r)}const Fn=jt(0,0,0,null);let R=class extends $e{constructor(){super(...arguments),this.enabled=!0}};u([$({type:Boolean})],R.prototype,"enabled",void 0),R=u([ve("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],R);let g=class extends $e{constructor(t){super(t),this.lineSnapper=new R,this.parallelLineSnapper=new R,this.rightAngleSnapper=new R,this.rightAngleTriangleSnapper=new R,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new Lt([255,127,0]),this.orangeTransparent=new Lt([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};u([$({type:R,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"lineSnapper",void 0),u([$({type:R,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"parallelLineSnapper",void 0),u([$({type:R,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleSnapper",void 0),u([$({type:R,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleTriangleSnapper",void 0),u([$({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"shortLineThreshold",void 0),u([$({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"distance",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointThreshold",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"intersectionParallelLineThreshold",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"parallelLineThreshold",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"verticalLineThresholdMeters",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"touchSensitivityMultiplier",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointOnLineThreshold",void 0),u([$({type:Lt,nonNullable:!0})],g.prototype,"orange",void 0),u([$({type:Lt,nonNullable:!0})],g.prototype,"orangeTransparent",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthReference",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthTarget",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"lineHintFadedExtensions",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"parallelLineHintWidth",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],g.prototype,"parallelLineHintLength",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"parallelLineHintOffset",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],g.prototype,"rightAngleHintSize",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],g.prototype,"rightAngleHintOutlineSize",void 0),u([$({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"satisfiesConstraintScreenThreshold",void 0),g=u([ve("esri.views.interactive.snapping.Settings.Defaults")],g);const hr=new g,dr=Symbol("grid-placement-graphic");function Gn(e,t){const n=e.x-t.x,s=e.y-t.y;return n*n+s*s}function fr(e,t){return Math.sqrt(Gn(e,t))}function yr(e,t){t.sort((n,s)=>Ut(n.targetPoint,e)-Ut(s.targetPoint,e))}function gr({parameters:{point:e,distance:t,returnEdge:n,vertexMode:s,coordinateHelper:{spatialReference:r},filter:i},mode:o,returnZ:a,filter:l}){const c=(l==null?void 0:l.clone())??new un({where:"1=1"});return c.returnZ=a??o==="3d",i&&(c.geometry=i.geometry,c.distance=i.distance,c.spatialRelationship=i.spatialRelationship,c.where=cn(c.where,i.where),c.timeExtent=pn(c.timeExtent,i.timeExtent),c.objectIds=Kn(c.objectIds,i.objectIds)),{point:jt(e[0],e[1],e[2],r.toJSON()),mode:o,distance:t,returnEdge:n,vertexMode:s,query:c.toJSON()}}function Kn(e,t){return e||t?t?e?Array.from(hn(new Set(e),new Set(t))):t:e:null}function vr(e,t,n){return{left:pe(e.leftVertex.pos,t,n),right:pe(e.rightVertex.pos,t,n)}}const he=Symbol("snapping-toggle");function $r(e,t=()=>{}){const n=dn(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:s,snappingOptions:r})=>{if(e.removeHandles(he),!s||!r)return;const i=gn.TOOL,o=[s.on("key-down",a=>{a.key!==ue.toggle||a.repeat||(r.enabledToggled=!0,t())},i),s.on("key-up",a=>{a.key===ue.toggle&&(r.enabledToggled=!1,t())},i),s.on("pointer-move",a=>{const l=a.native.ctrlKey;r.enabledToggled!==l&&(r.enabledToggled=l,t())},i)];e.addHandles(o,he)},fn);e.addHandles(n)}function br(e){var t;return yn(e)&&"utilityNetworks"in e&&!!((t=e.utilityNetworks)!=null&&t.length)}function mr(e){return(e==null?void 0:e.type)==="line"}function It(e,t){return e[0]*t[1]-e[1]*t[0]}function Yn(e,t,n){const s=lt(n,t)/et(n);return $n(e,n,s)}function xr(e,t,n,s,r=n){return k(tt,s,n),k(Tt,t,r),Yn(at,Tt,tt),vn(e,r,at)}function wr(e,t,n,s){k(tt,t,n);const r=s/be(tt);return V(e,n,tt,r)}function Nr(e,t){const n=e.start,s=e.end,r=t.start,i=t.end,o=k(tt,s,n),a=k(De,i,r),l=It(o,a);if(Math.abs(l)<=ts)return[];const c=k(Tt,n,r),p=It(a,c)/l,h=It(o,c)/l;if(p>=0){if(h>=0||t.type===1)return[V(at,n,o,p)]}else if(e.type===1&&(h>=0||t.type===1))return[V(at,n,o,p)];return[]}function Qn(e,t,n){const s=[],r=k(tt,e.end,e.start),i=k(De,e.start,t),o=et(r),a=2*lt(r,i),l=a*a-4*o*(et(i)-n*n);if(l===0){const c=-a/(2*o);(e.type===1||c>=0)&&s.push(V(at,e.start,r,c))}else if(l>0){const c=Math.sqrt(l),p=(-a+c)/(2*o);(e.type===1||p>=0)&&s.push(V(at,e.start,r,p));const h=(-a-c)/(2*o);(e.type===1||h>=0)&&s.push(V(Tt,e.start,r,h))}return s}const ts=1e-6,tt=H(),De=H(),Tt=H(),at=H();function Yt({start:e,end:t,type:n},s,r){const i=[],o=k(dt,t,e),a=k(Pt,e,s),l=et(o),c=2*lt(o,a),p=c*c-4*l*(et(a)-r*r);if(p===0){const h=-c/(2*l);(n===0||h>=0)&&i.push(V(H(),e,o,h))}else if(p>0){const h=Math.sqrt(p),b=(-c+h)/(2*l);(n===0||b>=0)&&i.push(V(H(),e,o,b));const v=(-c-h)/(2*l);(n===0||v>=0)&&i.push(V(H(),e,o,v))}return i}function Ie(e,t){const n=e.start,s=e.end,r=k(dt,s,n),i=G(Rt,-r[1],r[0],0),o=t.start,a=t.end,l=T(te,a,o),c=_(l,i),p=G(Ce,n[0],n[1],0),h=T(Fe,p,o),b=_(h,i),v=ht();if(Math.abs(c)<v)return[];const m=N(Ge,o,l,b/c);if(t.type===0){const M=T(Ct,m,o);if(_(M,l)<-v)return[]}if(e.type===1){const M=mn(Pt,m,n);if(lt(M,r)<-v)return[]}return[K(m)]}function es(e,t){return ss(St(ee,t[2],e),t)}function Ze(e,t){return Xe(St(ee,0,e),St(as,0,t)).map(([s,r])=>wt(s,r))}function Ve(e,t,n){return Ue(e,St(ee,e[2],t),n)}function Ae(e,t,n,s=f()){const r=k(dt,e,t),i=be(r);return V(s,t,r,i===0?1:n/i),s[2]=e[2],s}function Ue(e,{start:t,end:n,type:s},r=f()){const i=T(Ot,e,t),o=T(Rt,n,t),a=_(i,o)/_(o,o);return N(r,t,o,s===0?Math.max(a,0):a)}const ns=(()=>{const e=f(),t=f(),n=f();return({start:s,end:r},{center:i,radius:o,normal:a,slicePlane:l})=>{const c=Et(i,a,os);if(y(Jt(c,s),0)&&y(Jt(c,r),0)){ze(a,e,t);const h=(m,M)=>(Gt(n,M,i),xe(m,_(n,e),_(n,t)),m),b=Qn({start:h(dt,s),end:h(Pt,r),type:1},wn,o),v=[];for(const[m,M]of b){const z=me(f(),i);N(z,z,e,m),N(z,z,t,M),l&&!F(l,z)||v.push(z)}return v}const p=f();return je(c,s,r,p)?!y(ct(p,i),o)||l&&!F(l,p)?[]:[p]:[]}})();function We({start:e,end:t,type:n},s,r){const i=[],o=Gt(Ot,t,e),a=k(Pt,e,s),l=et(o),c=2*lt(o,a),p=c*c-4*l*(et(a)-r*r);if(p===0){const h=-c/(2*l);(n===1||h>=0)&&i.push(N(f(),e,o,h))}else if(p>0){const h=Math.sqrt(p),b=(-c+h)/(2*l);(n===1||b>=0)&&i.push(N(f(),e,o,b));const v=(-c-h)/(2*l);(n===1||v>=0)&&i.push(N(f(),e,o,v))}return i}function Xe(e,t){const n=e.start,s=e.end,r=t.start,i=t.end,o=T(Ot,s,n),a=T(Rt,i,r),l=T(te,r,n),c=kt(Ce,o,a);if(!y(_(l,c),0))return[];const p=Wt(c);if(y(p,0))return[];const h=kt(Fe,l,a),b=_(h,c)/p,v=N(Ge,n,o,b);if(e.type===0){const m=T(Ct,v,n);if(_(o,m)<-ht())return[]}if(t.type===0){const m=T(Ct,v,r);if(_(a,m)<-ht())return[]}return[K(v)]}function ss({start:e,end:t,type:n},s){const r=T(Ot,s,e),i=T(Rt,t,e),o=kt(te,i,r),a=Wt(o)/Wt(i),l=ht();if(a<l)switch(n){case 1:return[K(s)];case 0:return _(i,r)<-l?[]:[K(s)]}return[]}function Qt(e,t,n,s){const[r,i]=e,[o,a]=n,l=o-r,c=a-i,p=l*l+c*c,h=Math.sqrt(p);if(h>t+s)return[];if(h<Math.abs(t-s))return[];if(y(h,0)&&y(t,s))return[];const b=(t*t-s*s+p)/(2*h),v=Math.sqrt(t*t-b*b),m=v*c/h,M=v*l/h,[z,Q]=xn(dt,e,n,b/h);return y(m,M)?[wt(z,Q)]:[wt(z+m,Q-M),wt(z-m,Q+M)]}function St(e,t,{start:n,end:s,type:r}){return G(e.start,n[0],n[1],t),G(e.end,s[0],s[1],t),e.type=is[r],e}function Je(e,t){return y(e[2],t[2])}function y(e,t){return bn(Math.abs(e-t),0,ht())}function rs(e,t){return t.filter(n=>F(e,n))}function F(e,t){return Dn(e,t)}const is={0:1,1:0},dt=H(),Pt=H(),Ot=f(),Rt=f(),te=f(),Ce=f(),Fe=f(),Ge=f(),Ct=f(),os=q(),ee={start:f(),end:f(),type:1},as={start:f(),end:f(),type:1};class P{intersect(t){return A(this,t)}closestPoints(t){return[this.closestTo(t)]}}class ft extends P{constructor(t){super(),this.point=t}equals(t){return this===t||O(t)&&x(this.point,t.point)}closestTo(){return ot(this.point)}}class ne extends P{constructor(t,n,s){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:s}}equals(t){return this===t||D(t)&&this.lineLike.type===t.lineLike.type&&x(this.start,t.start)&&x(this.end,t.end)}closestTo(t){const n=S();return Ue(t,this.lineLike,n),n}}class Ke extends ne{constructor(t,n){super(t,n,1)}}class ls extends ne{constructor(t,n){super(t,n,0)}}class Ye extends P{constructor(t){super(),this.constraints=t}equals(t){return this===t||Ft(t)&&Mn(this.constraints,t.constraints,(n,s)=>n.equals(s))}closestTo(t){let n,s=1/0;for(const r of this.constraints){const i=r.closestTo(t),o=Ut(t,i);o<s&&(s=o,n=i)}return ot(n??t)}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}}class us extends P{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||Z(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const n=S();return Ae(t,this.center,this.radius,n),n}}class se extends P{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||W(t)&&x(this.center,t.center)&&this.radius===t.radius}closestTo(t){const n=S();return Ae(t,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new re(ot(this.center),this.radius,Y(0,0,1))}}class re extends P{constructor(t,n,s,r){super(),this.center=t,this.radius=n,this.normal=s,this.slicePlane=r}equals(t){return this===t||C(t)&&x(this.center,t.center)&&x(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:n,radius:s}=this;Ee(this.getPlane(cs),t,Zt);const r=T(Zt,Zt,n),i=Ln(r);if(y(i,0))return ot(t);const o=s/Math.sqrt(i),a=S();N(a,n,r,o);const{slicePlane:l}=this;if(l&&!F(l,a)){const c=oe(l,this);return(c==null?void 0:c.closestTo(t))??ot(t)}return a}getPlane(t=q()){return Et(this.center,this.normal,t)}}const Zt=f(),cs=q();class ps extends P{constructor(t){super(),this.z=t}equals(t){return this===t||U(t)&&this.z===t.z}closestTo(t){return Y(t[0],t[1],this.z)}getPlane(t=q()){return G(de,0,0,this.z),Et(de,En,t)}}const de=f();class ie extends P{constructor(t,n,s){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:s}}equals(t){return this===t||I(t)&&this.planeLike.type===t.planeLike.type&&x(this.start,t.start)&&x(this.end,t.end)}closestTo(t){const n=S();return Ve(t,this.planeLike,n),n}closestEndTo(t){const{start:n,end:s}=this.planeLike;return Math.sign(lt(k(hs,s,n),k(ds,t,n)))>0?this.end:this.start}getPlane(t=q()){const n=me(fe,this.end);return n[2]+=1,Zn(this.start,this.end,n,t)}getSlicePlane(t=q()){const{start:n,end:s,type:r}=this.planeLike;if(r===0)return;const i=G(fe,n[0],n[1],0),o=G(ye,s[0],s[1],0),a=Gt(ye,o,i);return Et(i,a,t),t}}const hs=H(),ds=H(),fe=f(),ye=f();class Mr extends ie{constructor(t,n){super(t,n,1)}}class Lr extends ie{constructor(t,n){super(t,n,0)}}class fs extends P{constructor(t,n){super(),this.sphere=new Vn(t,n),this._center=K(t)}equals(t){return this===t||X(t)&&this.sphere.exactEquals(t.sphere)}closestTo(t){const n=S();return this.sphere.projectPoint(t,n),n}get center(){return this._center}get radius(){return this.sphere.radius}}class ys extends P{constructor(t,n,s){super(),this.start=t,this.end=n,this.getZ=s,this.planeLike={start:t,end:n,type:0}}equals(t){return this===t||zt(t)&&x(this.start,t.start)&&x(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return xs(this,t)}addIfOnTheGround(t,n){for(const s of n){const r=this.getZ(s[0],s[1])??0;y(s[2],r)&&(s[2]=r,t.push(s))}}}class gs extends P{constructor(t,n,s){super(),this._x=t,this._y=n,this._z=s}equals(t){return this===t||Bs(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,n,s]){return He(this._x??t,this._y??n,this._z??s)}}class vs extends P{constructor(t,n,s,r,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=s,this._z=r,this._directionDegrees=i}equals(t){return this===t||Rs(t)&&ce(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,n,s]){return xe(ut,t,n),ce(ut,this._origin)||this._applyDirectionAndDistance(ut),He(ut[0],ut[1],this._z??s)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)Xt(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)bs(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=_e($s,this._origin,t,this._spatialReference);Xt(t,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const ut=[0,0],$s=new Te;function bs(e,t,n,s,r){let{azimuth:i,distance:o}=_e(ms,t,s,r);i??(i=0);let a=o*Math.cos((i-n)*qn);a=Math.max(0,a),Xt(e,t,n,a,r)}const ms=new Te;function xs(e,t){const n=S();return Ve(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??tn,n}function A(e,t){if(Ft(e)){const n=[];for(const s of e.constraints){const r=s.intersect(t);r&&n.push(r)}return ae(n)}if(Ft(t))return A(t,e);if(zt(e))return ge(e,t);if(zt(t))return ge(t,e);if(O(e)){const{point:n}=e;if(O(t))return x(n,t.point)?e:void 0;const s=t.closestTo(n);return Sn(s,n)?e:void 0}if(D(e)){if(O(t))return A(t,e);if(D(t))return B(Xe(e.lineLike,t.lineLike));if(U(t))return ws(e,t);if(I(t))return B(Ie(t.planeLike,e.lineLike));if(Z(t))return B(We(e.lineLike,t.center,t.radius));if(C(t))return B(ns(e.lineLike,t));if(W(t))return Ns(e,t);if(X(t))return Ms(e,t)}else if(U(e)){if(O(t)||D(t))return A(t,e);if(U(t))return Ls(e,t);if(I(t))return ks(e,t);if(Z(t))return _s(e,t);if(C(t))return Ss(e,t);if(W(t))return Ts(e,t);if(X(t))return zs(e,t)}else if(I(e)){if(O(t)||D(t)||U(t))return A(t,e);if(I(t))return Vt(Ze(e.planeLike,t.planeLike));if(Z(t))return Vt(Yt(e.planeLike,t.center,t.radius));if(C(t))return Es(e,t);if(W(t))return js(e,t);if(X(t))return qs(e,t)}else if(Z(e)){if(O(t)||D(t)||U(t)||I(t))return A(t,e);if(Z(t))return Vt(Qt(e.center,e.radius,t.center,t.radius));if(C(t))return void 0;if(W(t))return Ps(e,t);if(X(t))return void 0}else if(C(e)){if(O(t)||D(t)||U(t)||I(t)||Z(t))return A(t,e);if(C(t))return void 0;if(W(t))return t.asCircle(),void 0;if(X(t))return void 0}else if(W(e)){if(O(t)||D(t)||U(t)||I(t)||Z(t)||C(t))return A(t,e);if(W(t))return Os(t,e);if(X(t))return void 0}else if(X(e)){if(O(t)||D(t)||U(t)||I(t)||Z(t)||W(t))return A(t,e);if(X(t))return void 0}}const ws=(()=>{const e=q();return(t,n)=>{const{start:s,end:r}=t;if(Je(s,r)&&y(s[2],n.z))return t;const i=S();return je(n.getPlane(e),s,r,i)?new ft(i):void 0}})();function Ns({lineLike:e},{center:t,radius:n}){const s=t[2];return B(We(e,t,n).filter(r=>y(r[2],s)))}function Ms({lineLike:e},{sphere:t}){return B(t.intersectLine(e.start,e.end))}const oe=(()=>{const e=zn(),t=f(),n=f();return(s,r,i)=>{const{normal:o,center:a,radius:l}=r;ze(o,t,n);const c=qe(s),p=l*_(c,t),h=l*_(c,n);kn(e,a[0],a[1],a[2],1);const b=_n(s,e),v=Math.hypot(p,h),m=y(v,0);if(y(Jt(s,a),0)){if(m)return r;if(y(l,0))return!i||F(i,a)?new ft(ot(a)):void 0;kt(t,c,o),Tn(t,t);const Ht=new Array,$t=K(a);N($t,$t,t,l),i&&!F(i,$t)||Ht.push($t);const bt=K(a);return N(bt,bt,t,-l),i&&!F(i,bt)||Ht.push(bt),B(Ht)}if(m)return;const M=-b/v;if(Math.abs(M)>1||y(M,1))return;const z=Math.atan(p/h),Q=jn(M)-z,le=Math.PI-Q,yt=new Array,gt=f();N(gt,a,t,l*Math.cos(Q)),N(gt,gt,n,l*Math.sin(Q)),yt.push(gt);const vt=f();return N(vt,a,t,l*Math.cos(le)),N(vt,vt,n,l*Math.sin(le)),yt.push(vt),B(i?rs(i,yt):yt)}})();function Ls(e,t){return y(e.z,t.z)?e:void 0}function ks({z:e},{planeLike:t}){const[n,s]=t.start,[r,i]=t.end,o=Y(n,s,e),a=Y(r,i,e);return t.type===0?new Ke(o,a):new ls(o,a)}function _s(e,t){const[n,s]=t.center;return new se(Y(n,s,e.z),t.radius)}function Ts(e,t){return y(t.center[2],e.z)?t:void 0}const Ss=(()=>{const e=q();return(t,n)=>oe(t.getPlane(e),n,n.slicePlane)})();function zs(e,{center:t,radius:n}){const s=Math.abs(t[2]-e.z);if(s>n&&!y(s,n))return;const r=Y(t[0],t[1],e.z),i=Math.sqrt(n**2-s**2);return y(i,0)?void 0:new se(r,i)}const js=(()=>{const e=q();return(t,{center:n,radius:s})=>{const r=Yt(t.planeLike,n,s),i=n[2];t.getSlicePlane(e);const o=new Array;for(const[a,l]of r){const c=[a,l,i];F(e,c)&&o.push(c)}return B(o)}})(),Es=(()=>{const e=q(),t=q();return(n,s)=>oe(n.getPlane(e),s,n.getSlicePlane(t))})(),qs=(()=>{const e=q();return(t,{center:n,radius:s})=>{const r=t.getPlane(e),i=In(r,n),o=Math.abs(i);if(o>s&&!y(o,s))return;const a=Math.sqrt(s**2-i**2);if(y(a,0)){const p=S();return Ee(r,n,p),new ft(p)}const l=S(),c=K(qe(r));return N(l,n,c,i),new re(l,a,c,t.getSlicePlane())}})();function Ps(e,t){const n=we(e.center,t.center);return y(n,0)&&y(e.radius,t.radius)?t:Qe(Qt(e.center,e.radius,t.center,t.radius),t.center[2])}function Os(e,t){if(!Je(e.center,t.center))return;const n=we(e.center,t.center);return y(n,0)&&y(e.radius,t.radius)?e:Qe(Qt(e.center,e.radius,t.center,t.radius),e.center[2])}function ge(e,t){const{planeLike:n,getZ:s}=e,r=new Array;if(O(t))e.addIfOnTheGround(r,es(n,t.point));else if(D(t))e.addIfOnTheGround(r,Ie(n,t.lineLike));else if(Z(t))for(const[i,o]of Yt(n,t.center,t.radius)){const a=s(i,o);a!=null&&r.push(Mt(i,o,a))}else if(I(t)||zt(t))for(const[i,o]of Ze(n,t.planeLike)){const a=s(i,o)??tn;r.push(Mt(i,o,a))}return B(r)}function Vt(e){return ae(e.map(([t,n])=>{const s=Y(t,n,0),r=Y(t,n,1);return new Ke(s,r)}))}function B(e){return ae(e.map(t=>t?new ft(t):void 0))}function Qe(e,t){return B(e.map(([n,s])=>[n,s,t]))}function ae(e){if(e.length!==0)return e.length===1?e[0]??void 0:new Ye(e.filter(Nn))}function Ft(e){return e instanceof Ye}function O(e){return e instanceof ft}function D(e){return e instanceof ne}function U(e){return e instanceof ps}function I(e){return e instanceof ie}function Z(e){return e instanceof us}function W(e){return e instanceof se}function C(e){return e instanceof re}function X(e){return e instanceof fs}function zt(e){return e instanceof ys}function Rs(e){return e instanceof vs}function Bs(e){return e instanceof gs}const tn=0;let Bt=class{constructor(t,n){this.isDraped=t,this.domain=n}};class en extends Bt{constructor(t,n,s,r,i=3,o=!0,a=!0){super(r,i),this.type=t,this.lineStart=n,this.lineEnd=s,this.fadeLeft=o,this.fadeRight=a}equals(t){return t instanceof en&&this.type===t.type&&x(this.lineStart,t.lineStart)&&x(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return ct(this.lineStart,this.lineEnd)}}class nn extends Bt{constructor(t,n,s=3){super(n,s),this.intersectionPoint=t}equals(t){return t instanceof nn&&x(this.intersectionPoint,t.intersectionPoint)}}let _r=class sn extends Bt{constructor(t,n,s,r=3){super(s,r),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof sn&&x(this.lineStart,t.lineStart)&&x(this.lineEnd,t.lineEnd)}},Tr=class rn extends Bt{constructor(t,n,s,r,i=3){super(r,i),this.previousVertex=t,this.centerVertex=n,this.nextVertex=s}equals(t){return t instanceof rn&&x(this.previousVertex,t.previousVertex)&&x(this.centerVertex,t.centerVertex)&&x(this.nextVertex,t.nextVertex)}};function Sr(e){return Se(e)||Ne(e)}function zr(e,t,n,...s){return Se(e)?t.apply(void 0,s):e.isWebMercator?n.apply(void 0,s):null}function on(e){return Pn(e)?On(e)||Ne(e)||Rn(e)||Bn(e)?Xn:e:Jn(e)}function jr(e){return Hs(e)}function Hs(e,t){const{hasZ:n,spatialReference:s}=e,r=on(s);let i=0;const o=Le(r);if(o==null)return null;const a=an;for(const l of e.paths){if(l.length<2)continue;const c=l.length-1;for(let p=0;p<c;++p){const h=l[p];j[0]=h[0],j[1]=h[1],j[2]=n?h[2]:0;const b=l[p+1];E[0]=b[0],E[1]=b[1],E[2]=n?b[2]:0;const v=a(j,E,s);if(v==null)return null;i+=v.value}}return qt(i,o)}function Er(e,t){const{spatialReference:n}=e;return Me(n,t.spatialReference)?(j[0]=e.x,j[1]=e.y,j[2]=e.hasZ?e.z:0,E[0]=t.x,E[1]=t.y,E[2]=t.hasZ?t.z:0,an(j,E,n)):null}function qr(e,t){const{spatialReference:n}=e;return Me(n,t.spatialReference)?(j[0]=e.x,j[1]=e.y,j[2]=e.hasZ?e.z:0,E[0]=t.x,E[1]=t.y,E[2]=t.hasZ?t.z:0,Is(j,E,n)):null}function Pr(e){return e!=null?Ds(e.hasZ?e.z:0,e.spatialReference):null}function Ds(e,t){const n=Hn(t);return n!=null?qt(e??0,n):null}function an(e,t,n){const s=ln(e,t,n,1);return s!=null?qt(s.horizontal,s.unit):null}function Is(e,t,n){const s=ln(e,t,n,2);return s!=null?qt(s.verticalSigned,s.unit):null}function ln(e,t,n,s){const r=on(n),i=Le(r);if(i==null)return null;const o=t[2]-e[2];if(s===2)return{verticalSigned:o,unit:i};if(!Dt(e,n,At,r)||!Dt(t,n,mt,r))return null;if(s===0)return{direct:ct(mt,At),unit:i};if(G(xt,e[0],e[1],t[2]),!Dt(xt,n,xt,r))return null;const a=ct(xt,mt);return s===1?{horizontal:a,unit:i}:{direct:ct(mt,At),horizontal:a,vertical:Math.abs(o),unit:i}}const j=f(),E=f(),At=f(),mt=f(),xt=f();function Zs(e){return(e==null?void 0:e.type)==="graphic"}function Or(e){return e.find(Zs)??null}export{ar as $,_r as A,Tr as B,Sr as C,Cn as D,ur as E,gs as F,us as G,ae as H,ps as I,Ds as J,Pe as K,O as L,Nr as M,$r as N,Ue as O,ys as P,Ke as Q,vs as R,Lr as S,zr as T,on as U,jr as V,Er as W,an as X,Re as Y,Be as Z,lr as _,Bt as a,cr as a0,qr as a1,Is as a2,or as b,Y as c,dr as d,gr as e,S as f,sr as g,ft as h,fr as i,rr as j,Pr as k,He as l,pe as m,Gn as n,mr as o,hr as p,vr as q,xr as r,ir as s,wr as t,Or as u,nn as v,Mr as w,br as x,yr as y,en as z};
