const I=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],E=["آ","أ","إ","ا"],$=["ﻵ","ﻷ","ﻹ","ﻻ"],tt=["ﻶ","ﻸ","ﻺ","ﻼ"],j=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],rt=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],et=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],nt=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],ot=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],z=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],it=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],q=["ء","ف"],at=["غ","ي"],st=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ut=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],e=0,a=1,h=2,g=3,t=4,S=5,W=6,r=7,m=8,R=9,_=10,T=11,n=12,ft=13,ct=14,lt=15,ht=16,Tt=17,l=18,At=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],p=100,Lt=[p+0,e,e,e,e,p+1,p+2,p+3,a,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,p+4,t,t,t,e,t,e,t,e,t,t,t,e,e,t,t,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,e,e,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,p+5,r,r,p+6,p+7],dt=[[l,l,l,l,l,l,l,l,l,W,S,W,m,S,l,l,l,l,l,l,l,l,l,l,l,l,l,l,S,S,S,W,m,t,t,T,T,T,t,t,t,t,t,_,R,_,R,R,h,h,h,h,h,h,h,h,h,h,R,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,l,l,l,l,l,l,S,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,R,t,T,T,T,T,t,t,t,t,e,t,t,l,t,t,T,T,h,h,t,e,t,t,t,h,e,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,a,n,a,n,n,a,n,n,a,n,t,t,t,t,t,t,t,t,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,t,t,t,t,t,a,a,a,a,a,t,t,t,t,t,t,t,t,t,t,t],[g,g,g,g,t,t,t,t,r,T,T,r,R,r,t,t,n,n,n,n,n,n,n,n,n,n,n,r,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,g,g,g,g,g,g,g,g,g,g,T,g,g,r,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,g,t,n,n,n,n,n,n,r,r,n,n,t,n,n,n,n,r,r,h,h,h,h,h,h,h,h,h,h,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,n,n,n,n,n,n,n,n,n,a,a,t,t,t,t,a,t,t,t,t,t],[m,m,m,m,m,m,m,m,m,m,m,l,l,l,e,a,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,S,ft,ct,lt,ht,Tt,R,T,T,T,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,R,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,l,l,l,l,l,t,t,t,t,t,l,l,l,l,l,l,h,e,t,t,h,h,h,h,h,h,_,_,t,t,t,e,h,h,h,h,h,h,h,h,h,h,_,_,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,t,t,t,t,t,a,n,a,a,a,a,a,a,a,a,a,a,_,a,a,a,a,a,a,a,a,a,a,a,a,a,t,a,a,a,a,a,t,a,t,a,a,t,a,a,t,a,a,a,a,a,a,a,a,a,a,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,R,t,R,t,t,R,t,t,t,t,t,t,t,t,t,T,t,t,_,_,t,t,t,t,t,T,T,t,t,t,t,t,r,r,r,r,r,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,l],[t,t,t,T,T,T,t,t,t,t,t,_,R,_,R,R,h,h,h,h,h,h,h,h,h,h,R,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,t,t,t,T,T,t,t,t,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class kt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(o,s,u){if(this.sourceToTarget=[],this.targetToSource=[],!o)return"";if(Ot(this.sourceToTarget,this.targetToSource,o.length),!this.checkParameters(s,u))return o;s=this.inputFormat,u=this.outputFormat;let f=o;const c=It,L=H(s.charAt(1)),A=H(u.charAt(1)),d=(s.startsWith("I")?"L":s.charAt(0))+L,U=(u.startsWith("I")?"L":u.charAt(0))+A,B=s.charAt(2)+u.charAt(2);c.defInFormat=d,c.defOutFormat=U,c.defSwap=B;const w=V(o,d,U,B,c);let N=!1;return u.charAt(1)==="R"?N=!0:u.charAt(1)!=="C"&&u.charAt(1)!=="D"||(N=this.checkContextual(w)==="rtl"),this.sourceToTarget=F,this.targetToSource=xt(this.sourceToTarget),k=this.targetToSource,f=s.charAt(3)===u.charAt(3)?w:u.charAt(3)==="S"?gt(N,w):Rt(w,N,!0),this.sourceToTarget=F,this.targetToSource=k,this.levels=P,f}_inputFormatSetter(o){if(!J.test(o))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=o}_outputFormatSetter(o){if(!J.test(o))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=o}checkParameters(o,s){return o?this._inputFormatSetter(o):o=this.inputFormat,s?this._outputFormatSetter(s):s=this.outputFormat,o!==s}checkContextual(o){let s=D(o);if(s!=="ltr"&&s!=="rtl"){try{s=document.dir.toLowerCase()}catch{}s!=="ltr"&&s!=="rtl"&&(s="ltr")}return s}hasBidiChar(o){return Dt.test(o)}}function V(i,o,s,u,f){const c=Ut(i,{inFormat:o,outFormat:s,swap:u},f);if(c.inFormat===c.outFormat)return i;o=c.inFormat,s=c.outFormat,u=c.swap;const L=o.slice(0,1),A=o.slice(1,4),d=s.slice(0,1),U=s.slice(1,4);if(f.inFormat=o,f.outFormat=s,f.swap=u,L==="L"&&s==="VLTR"){if(A==="LTR")return f.dir=v,b(i,f);if(A==="RTL")return f.dir=O,b(i,f)}if(L==="V"&&d==="V")return f.dir=A==="RTL"?O:v,M(i,f);if(L==="L"&&s==="VRTL")return A==="LTR"?(f.dir=v,i=b(i,f)):(f.dir=O,i=b(i,f)),M(i);if(o==="VLTR"&&s==="LLTR")return f.dir=v,b(i,f);if(L==="V"&&d==="L"&&A!==U)return i=M(i),A==="RTL"?V(i,"LLTR","VLTR",u,f):V(i,"LRTL","VRTL",u,f);if(o==="VRTL"&&s==="LRTL")return V(i,"LRTL","VRTL",u,f);if(L==="L"&&d==="L"){const B=f.swap;return f.swap=B.slice(0,1)+"N",A==="RTL"?(f.dir=O,i=b(i,f),f.swap="N"+B.slice(1,3),f.dir=v,i=b(i,f)):(f.dir=v,i=b(i,f),f.swap="N"+B.slice(1,3),i=V(i,"VLTR","LRTL",f.swap,f)),i}return i}function Ut(i,o,s){if(o.inFormat===void 0&&(o.inFormat=s.defInFormat),o.outFormat===void 0&&(o.outFormat=s.defOutFormat),o.swap===void 0&&(o.swap=s.defSwap),o.inFormat===o.outFormat)return o;const u=o.inFormat.slice(0,1),f=o.outFormat.slice(0,1);let c,L=o.inFormat.slice(1,4),A=o.outFormat.slice(1,4);return L.startsWith("C")&&(c=D(i),L=c==="ltr"||c==="rtl"?c.toUpperCase():o.inFormat.charAt(2)==="L"?"LTR":"RTL",o.inFormat=u+L),A.startsWith("C")&&(c=D(i),c==="rtl"?A="RTL":c==="ltr"?(c=mt(i),A=c.toUpperCase()):A=o.outFormat.charAt(2)==="L"?"LTR":"RTL",o.outFormat=f+A),o}function gt(i,o,s){if(o.length===0)return"";i===void 0&&(i=!0);const u=(o=String(o)).split("");let f=0,c=1,L=u.length;i||(f=u.length-1,c=-1,L=1);const A=Bt(u,f,c,L);let d="";for(let U=0;U<u.length;U++)St(A,A.length,U)>-1?(X(k,U,!i,-1),F.splice(U,1)):d+=u[U];return d}function Bt(i,o,s,u,f){let c=0;const L=[];let A=0;for(let d=o;d*s<u;d+=s)if(Q(i[d])||x(i[d])){if(i[d]==="ل"&&bt(i,d+s,s,u)){i[d]=Vt(i[d+s],c===0?$:tt),d+=s,Et(i,d,s,u),L[A]=d,A++,c=0;continue}const U=i[d];c===1?i[d]=Z(i,d+s,s,u)?vt(i[d]):Y(i[d],et):Z(i,d+s,s,u)===!0?i[d]=Y(i[d],ot):i[d]=Y(i[d],rt),x(U)||(c=1),Ct(U)===!0&&(c=0)}else c=0;return L}function D(i){const o=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(i);return o?o[0]<="z"?"ltr":"rtl":""}function mt(i){const o=i.split("");return o.reverse(),D(o.join(""))}function Rt(i,o,s){if(i.length===0)return"";o===void 0&&(o=!0);let u="";const f=(i=String(i)).split("");for(let c=0;c<i.length;c++){let L=!1;if(f[c]>="ﹰ"&&f[c]<"\uFEFF"){const A=i.charCodeAt(c);f[c]>="ﻵ"&&f[c]<="ﻼ"?(o?(c>0&&s&&f[c-1]===" "?u=u.slice(0,-1)+"ل":(u+="ل",L=!0),u+=E[(A-65269)/2]):(u+=E[(A-65269)/2],u+="ل",c+1<i.length&&s&&f[c+1]===" "?c++:L=!0),L&&(X(k,c,!0,1),F.splice(c,0,F[c]))):u+=it[A-65136]}else u+=f[c]}return u}function b(i,o){const s=i.split(""),u=[];return K(s,u,o),_t(s,u,o),G(2,s,u,o),G(1,s,u,o),P=u,s.join("")}function K(i,o,s){const u=i.length,f=s.dir?ut:st;let c=0,L=-1;const A=[],d=[];s.hiLevel=s.dir,s.lastArabic=!1,s.hasUbatAl=!1,s.hasUbatB=!1,s.hasUbatS=!1;for(let U=0;U<u;U++)A[U]=pt(i[U]);for(let U=0;U<u;U++){const B=c,w=wt(i,A,d,U,s);d[U]=w,c=f[B][w];const N=240&c;c&=15;const y=f[c][Wt];if(o[U]=y,N>0)if(N===16){for(let C=L;C<U;C++)o[C]=1;L=-1}else L=-1;if(f[c][jt])L===-1&&(L=U);else if(L>-1){for(let C=L;C<U;C++)o[C]=y;L=-1}A[U]===S&&(o[U]=0),s.hiLevel|=y}s.hasUbatS&&Ft(A,o,u,s)}function Ft(i,o,s,u){for(let f=0;f<s;f++)if(i[f]===W){o[f]=u.dir;for(let c=f-1;c>=0&&i[c]===m;c--)o[c]=u.dir}}function _t(i,o,s){if(s.hiLevel!==0&&s.swap[0]!==s.swap[1])for(let u=0;u<i.length;u++)o[u]===1&&(i[u]=Nt(i[u]))}function pt(i){const o=i.charCodeAt(0),s=Lt[o>>8];return s<p?s:dt[s-p][255&o]}function M(i,o){const s=i.split("");if(o){const u=[];K(s,u,o),P=u}return s.reverse(),F.reverse(),s.join("")}function St(i,o,s){for(let u=0;u<o;u++)if(i[u]===s)return u;return-1}function Q(i){for(let o=0;o<q.length;o++)if(i>=q[o]&&i<=at[o])return!0;return!1}function Z(i,o,s,u){for(;o*s<u&&x(i[o]);)o+=s;return!!(o*s<u&&Q(i[o]))}function bt(i,o,s,u){for(;o*s<u&&x(i[o]);)o+=s;let f=" ";if(!(o*s<u))return!1;f=i[o];for(let c=0;c<E.length;c++)if(E[c]===f)return!0;return!1}function G(i,o,s,u){if(u.hiLevel<i)return;if(i===1&&u.dir===O&&!u.hasUbatB)return o.reverse(),void F.reverse();const f=o.length;let c,L,A,d,U,B=0;for(;B<f;){if(s[B]>=i){for(c=B+1;c<f&&s[c]>=i;)c++;for(L=B,A=c-1;L<A;L++,A--)d=o[L],o[L]=o[A],o[A]=d,U=F[L],F[L]=F[A],F[A]=U;B=c}B++}}function wt(i,o,s,u,f){const c=o[u];return{UBAT_L:()=>(f.lastArabic=!1,e),UBAT_R:()=>(f.lastArabic=!1,a),UBAT_ON:()=>t,UBAT_AN:()=>g,UBAT_EN:()=>f.lastArabic?g:h,UBAT_AL:()=>(f.lastArabic=!0,f.hasUbatAl=!0,a),UBAT_WS:()=>t,UBAT_CS:()=>{let L,A;return u<1||u+1>=o.length||(L=s[u-1])!==h&&L!==g||(A=o[u+1])!==h&&A!==g?t:(f.lastArabic&&(A=g),A===L?A:t)},UBAT_ES:()=>(u>0?s[u-1]:S)===h&&u+1<o.length&&o[u+1]===h?h:t,UBAT_ET:()=>{if(u>0&&s[u-1]===h)return h;if(f.lastArabic)return t;let L=u+1;const A=o.length;for(;L<A&&o[L]===T;)L++;return L<A&&o[L]===h?h:t},UBAT_NSM:()=>{if(f.inFormat==="VLTR"){const L=o.length;let A=u+1;for(;A<L&&o[A]===n;)A++;if(A<L){const d=i[u].charCodeAt(0),U=d>=1425&&d<=2303||d===64286,B=o[A];if(U&&(B===a||B===r))return a}}return u<1||o[u-1]===S?t:s[u-1]},UBAT_B:()=>(f.lastArabic=!0,f.hasUbatB=!0,f.dir),UBAT_S:()=>(f.hasUbatS=!0,t),UBAT_LRE:()=>(f.lastArabic=!1,t),UBAT_RLE:()=>(f.lastArabic=!1,t),UBAT_LRO:()=>(f.lastArabic=!1,t),UBAT_RLO:()=>(f.lastArabic=!1,t),UBAT_PDF:()=>(f.lastArabic=!1,t),UBAT_BN:()=>t}[At[c]]()}function Nt(i){let o,s=0,u=I.length-1;for(;s<=u;)if(o=Math.floor((s+u)/2),i<I[o][0])u=o-1;else{if(!(i>I[o][0]))return I[o][1];s=o+1}return i}function Ct(i){for(let o=0;o<z.length;o++)if(z[o]===i)return!0;return!1}function vt(i){for(let o=0;o<j.length;o++)if(i===j[o])return nt[o];return i}function Y(i,o){for(let s=0;s<j.length;s++)if(i===j[s])return o[s];return i}function x(i){return i>="ً"&&i<="ٕ"}function H(i){return i==="L"?"LTR":i==="R"?"RTL":i==="C"?"CLR":i==="D"?"CRL":""}function Et(i,o,s,u){for(;o*s<u&&x(i[o]);)o+=s;return o*s<u&&(i[o]=" ",!0)}function Vt(i,o){for(let s=0;s<E.length;s++)if(i===E[s])return o[s];return i}function Ot(i,o,s){F=[],P=[];for(let u=0;u<s;u++)i[u]=u,o[u]=u,F[u]=u}function xt(i){const o=new Array(i.length);for(let s=0;s<i.length;s++)o[i[s]]=s;return o}function X(i,o,s,u){for(let f=0;f<i.length;f++)(i[f]>o||!s&&i[f]===o)&&(i[f]+=u)}let F=[],k=[],P=[];const It={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},Wt=5,jt=6,v=0,O=1,J=/^[(I|V)][(L|RCD)][(Y|N)][(S|N)]N$/,Dt=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{kt as C};
