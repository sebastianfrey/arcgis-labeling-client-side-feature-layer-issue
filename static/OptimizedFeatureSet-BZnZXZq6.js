import{e as M}from"./memoryEstimations-w0EAmzVg.js";import{s as q}from"./OptimizedGeometry-KE6YknPZ.js";function V(t,e){return t?e?4:3:e?3:2}function O(t){if(t==null||!(t!=null&&t.lengths.length))return null;const{lengths:e,coords:r,stride:n,hasZ:s,hasM:u}=t,c=new q([],[],s,!1),i=c.coords,o=[],h=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];let N=0;for(const l of e){const I=P(h,r,N,l,s,u);I&&o.push(I),N+=l*n}if(o.sort((l,I)=>{let f=l[2]-I[2];return f===0&&s&&(f=l[4]-I[4]),f}),o.length){let l=6*o[0][2];i[0]=o[0][0]/l,i[1]=o[0][1]/l,s&&(l=6*o[0][4],i[2]=l!==0?o[0][3]/l:0),(i[0]<h[0]||i[0]>h[1]||i[1]<h[2]||i[1]>h[3]||s&&(i[2]<h[4]||i[2]>h[5]))&&(i.length=0)}if(!i.length){const l=t.lengths[0]?S(r,0,e[0],s,u):null;if(!l)return null;i[0]=l[0],i[1]=l[1],s&&(i[2]=l[2]??0)}return c}function P(t,e,r,n,s,u){const c=V(s,u);let i=r,o=r+c,h=0,N=0,l=0,I=0,f=0;for(let b=0,F=n-1;b<F;b++,i+=c,o+=c){const a=e[i],m=e[i+1],y=e[i+2],d=e[o],T=e[o+1],G=e[o+2];let p=a*T-d*m;I+=p,h+=(a+d)*p,N+=(m+T)*p,s&&(p=a*G-d*y,l+=(y+G)*p,f+=p),a<t[0]&&(t[0]=a),a>t[1]&&(t[1]=a),m<t[2]&&(t[2]=m),m>t[3]&&(t[3]=m),s&&(y<t[4]&&(t[4]=y),y>t[5]&&(t[5]=y))}if(I>0&&(I*=-1),f>0&&(f*=-1),!I)return null;const g=[h,N,.5*I];return s&&(g[3]=l,g[4]=.5*f),g}function S(t,e,r,n,s){const u=V(n,s);let c=e,i=e+u,o=0,h=0,N=0,l=0;for(let I=0,f=r-1;I<f;I++,c+=u,i+=u){const g=t[c],b=t[c+1],F=t[c+2],a=t[i],m=t[i+1],y=t[i+2],d=n?_(g,b,F,a,m,y):w(g,b,a,m);if(d)if(o+=d,n){const T=j(g,b,F,a,m,y);h+=d*T[0],N+=d*T[1],l+=d*T[2]}else{const T=A(g,b,a,m);h+=d*T[0],N+=d*T[1]}}return o>0?n?[h/o,N/o,l/o]:[h/o,N/o]:r>0?n?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function w(t,e,r,n){const s=r-t,u=n-e;return Math.sqrt(s*s+u*u)}function _(t,e,r,n,s,u){const c=n-t,i=s-e,o=u-r;return Math.sqrt(c*c+i*i+o*o)}function A(t,e,r,n){return[t+.5*(r-t),e+.5*(n-e)]}function j(t,e,r,n,s,u){return[t+.5*(n-t),e+.5*(s-e),r+.5*(u-r)]}class E{constructor(e=null,r={},n,s,u=0){this.geometry=e,this.attributes=r,this.centroid=n,this.objectId=s,this.displayId=u}static fromJSON(e){const r=e.geometry?q.fromJSON(e.geometry):null,n=e.centroid?q.fromJSON(e.centroid):null,s=e.objectId;return new E(r,e.attributes,n,s)}weakClone(){const e=new E(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){var n,s;const e=(n=this.geometry)==null?void 0:n.clone(),r=new E(e,{...this.attributes},(s=this.centroid)==null?void 0:s.clone(),this.objectId);return r.displayId=this.displayId,r}ensureCentroid(e){return this.centroid??(this.centroid=O(this.geometry)),this.centroid}get usedMemory(){var e;return 128+M(this.attributes)+(((e=this.geometry)==null?void 0:e.usedMemory)??0)}}function $(t){var e,r;return!!((r=(e=t.geometry)==null?void 0:e.coords)!=null&&r.length)}class Y{constructor(){this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new Y;return e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}export{Y as e,E as o,O as r,$ as s};
